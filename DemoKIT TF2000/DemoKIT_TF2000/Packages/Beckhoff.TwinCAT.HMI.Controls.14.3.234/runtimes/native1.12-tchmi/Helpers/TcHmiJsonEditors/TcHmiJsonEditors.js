"use strict";!function(TcHmi){!function(Controls){!function(Helpers){class EditorFactory{static#tchmiFQN="TcHmi.Controls.Helpers."+this.name;__customEditors=[];__options;constructor(options){this.__options={...options,factorySettings:{preferPanes:"No",...options?.factorySettings}},this.registerEditor("historizedSymbol",{singleLine:Helpers.HistorizedSymbolEditor,pane:Helpers.HistorizedSymbolEditorPane})}fromSymbol(symbol,element){return new Promise((resolve,reject)=>{const onSchemaResolved=data=>{data.error===TcHmi.Errors.NONE&&data.schema?resolve(this.fromSchema(data.schema,element)):reject(new TcHmi.Exception(data.details??{code:data.error!==TcHmi.Errors.NONE?data.error:TcHmi.Errors.E_SYMBOL_RESOLVE_SCHEMA,reason:`Could not resolve schema of symbol "${symbol instanceof TcHmi.Symbol?symbol.getExpression().toString():symbol.toString()}"`,domain:EditorFactory.#tchmiFQN}))};symbol instanceof TcHmi.Symbol?symbol.resolveSchema(onSchemaResolved):TcHmi.Symbol.resolveSchema(symbol.toString(),onSchemaResolved)})}fromType(type,element){const schema=TcHmi.Type.getSchema(type);if(!schema)throw new TcHmi.Exception(TcHmi.Errors.E_UNKNOWN_TYPE,`Could not resolve schema of type "${type}"`,EditorFactory.#tchmiFQN);return this.fromSchema(schema,element)}fromSchema(schema,element){return this.__options.nameGenerator?this.fromEditorInfo(Helpers.SchemaParser.parse(schema,this.__options.nameGenerator),element):this.fromEditorInfo(Helpers.SchemaParser.parse(schema),element)}fromEditorInfo(info,element,parent=null){let editor=null;const customEditor=this.__customEditors.find(entry=>entry.predicate(info.schema,info))?.editor;if(customEditor)try{editor=customEditor.pane&&("Always"===this.__options.factorySettings.preferPanes||"FirstLevel"===this.__options.factorySettings.preferPanes&&!parent)?new customEditor.pane(element,info,this):new customEditor.singleLine(element,info,this)}catch(error){TcHmi.Log.errorEx(`[Source=ControlHelpers, Module=${EditorFactory.#tchmiFQN}${this.__options.parentControl?`, Id=${this.__options.parentControl.getId()}`:""}] Failed to create custom editor for EditorInfo "${info.name}" of type "${info.type}". Falling back to basic editor.`,error)}if(!editor)switch(info.type){case"boolean":editor=new Helpers.BooleanEditor(element,info,this);break;case"number":editor=new Helpers.NumberEditor(element,info,this);break;case"string":editor=new Helpers.StringEditor(element,info,this);break;case"time":editor=new Helpers.TimeEditor(element,info,this);break;case"enum":editor=new Helpers.EnumEditor(element,info,this);break;case"object":editor="Always"===this.__options.factorySettings.preferPanes||"FirstLevel"===this.__options.factorySettings.preferPanes&&!parent?new Helpers.ObjectEditorPane(element,info,this):new Helpers.ObjectEditor(element,info,this);break;case"array":editor="Always"===this.__options.factorySettings.preferPanes||"FirstLevel"===this.__options.factorySettings.preferPanes&&!parent?new Helpers.ArrayEditorPane(element,info,this):new Helpers.ArrayEditor(element,info,this);break;case"tuple":editor="Always"===this.__options.factorySettings.preferPanes||"FirstLevel"===this.__options.factorySettings.preferPanes&&!parent?new Helpers.TupleEditorPane(element,info,this):new Helpers.TupleEditor(element,info,this);break;case"optional":editor=new Helpers.OptionalEditor(element,info,this);break;case"choice":editor=new Helpers.ChoiceEditor(element,info,this);break;case"null":editor=new Helpers.NullEditor(element,info,this);break;case"invalid":editor=new Helpers.InvalidEditor(element,info,this)}return this.__options.texts?editor.setLocalizations(this.__options.texts):editor.setLocalizations({}),this.__options.editorSettings&&editor.setSettings(this.__options.editorSettings),void 0!==info.defaultValue&&editor.setValue(info.defaultValue),editor}registerEditor(predicateOrMetaType,editor){let predicate;switch(typeof predicateOrMetaType){case"function":predicate=predicateOrMetaType;break;case"string":predicate=(schema,_info)=>schema.frameworkMetaType===predicateOrMetaType;break;case"object":predicate=(schema,_info)=>void 0!==schema.frameworkMetaType&&predicateOrMetaType.includes(schema.frameworkMetaType)}return this.__customEditors.unshift({predicate,editor:"function"==typeof editor?{singleLine:editor}:editor}),this}get parentControl(){return this.__options.parentControl??null}set parentControl(control){this.__options.parentControl=control}get texts(){return this.__options.texts??null}set texts(texts){texts?this.__options.texts=texts:delete this.__options.texts}get editorSettings(){return this.__options.editorSettings??null}set editorSettings(settings){settings?this.__options.editorSettings=settings:delete this.__options.editorSettings}get factorySettings(){return this.__options.factorySettings}set factorySettings(settings){this.__options.factorySettings={preferPanes:"No",...settings}}get nameGenerator(){return this.__options.nameGenerator??null}set nameGenerator(nameGenerator){nameGenerator?this.__options.nameGenerator=nameGenerator:delete this.__options.nameGenerator}}Helpers.EditorFactory=EditorFactory}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){let SchemaParser;!function(SchemaParser){const __restrictions=new Map([["number",["maximum","minimum","exclusiveMaximum","exclusiveMinimum","multipleOf"]],["string",["maxLength","minLength","pattern","format"]],["object",["properties","patternProperties","dependencies","maxProperties","minProperties","required","additionalProperties"]],["array",["additionalItems","items","maxItems","minItems","uniqueItems"]]]),__cloneEditorInfoOptions={cloneMaps:{deepCloneKeys:!0,deepCloneValues:!0},cloneSets:{deepCloneValues:!0},cloneDates:!0,resolveRecursiveReferences:!0},__compareEditorInfoOptions={compareMaps:{deepCompareKeys:!0,deepCompareValues:!0},compareSets:{deepCompareValues:!0},compareDates:!0},__parsedSchemas=new WeakMap,__mergedEditorInfos=new WeakMap;function __parse(schema,nameGenerator){const editorInfo=__mergeEditorInfos(...function(schema){if(!schema.allOf?.length)return[schema];const schemas=[...schema.allOf];Object.keys(schema).length>1&&schemas.unshift(schema);return schemas}(schema).map(schema=>{const editorInfo=__parsedSchemas.get(schema);if(editorInfo)return editorInfo;const types=__findPossibleEditorTypes(schema),condensedTypes=[],convertedTypes=[],condense=type=>{let condensedType;return["boolean","number","string","time","enum","null"].includes(type.editorType)&&(condensedType=condensedTypes.find(condensed=>condensed.editorType===type.editorType&&condensed.id===type.schema.id&&condensed.title===type.schema.title)),condensedType?condensedType.condensedFrom.push(type):(condensedType={editorType:type.editorType,convertibles:[],condensedFrom:[type]},type.schema.id&&(condensedType.id=type.schema.id),type.schema.title&&(condensedType.title=type.schema.title),condensedTypes.push(condensedType)),condensedType};for(const type of types)type.convert?convertedTypes.push(type):condense(type);for(const type of convertedTypes){const existingTypes=condensedTypes.filter(condensed=>condensed.condensedFrom.some(condensedFrom=>condensedFrom.rawType===type.convert));if(existingTypes.length>0)for(const existingType of existingTypes)existingType.convertibles.push(type);else{const condensedType=condense(type);condensedType.convertibles.push(...convertedTypes.filter(converted=>converted!==type&&condensedType.condensedFrom.some(condensedFrom=>condensedFrom.rawType===converted.convert)))}}const editorInfoRef={type:"invalid",schema,name:""};return __parsedSchemas.set(schema,editorInfoRef),__createEditorInfo(condensedTypes,editorInfoRef,nameGenerator)}));return editorInfo.schema=schema,editorInfo}function resolveReferences(schema){schema=tchmi_clone_object(schema);const knownRefs=new Map,resolve=schema=>{if(null!==schema&&"object"==typeof schema){if("string"==typeof schema.$ref){let subSchema=knownRefs.get(schema.$ref);if(!subSchema){if(subSchema=tchmi_clone_object(TcHmi.Type.getSchema(schema.$ref)??void 0),!subSchema)throw new Error(TcHmi.Log.buildMessage({code:TcHmi.Errors.ERROR,message:TcHmi.Errors[TcHmi.Errors.ERROR],domain:"TcHmi.Controls.Helpers.SchemaParser",reason:`Unknown schema reference ${schema.$ref}.`}));knownRefs.set(schema.$ref,subSchema),knownRefs.set(schema.$ref,resolve(subSchema))}return subSchema}if(Array.isArray(schema))for(let i=0,ii=schema.length;i<ii;i++)null!==schema[i]&&"object"==typeof schema[i]&&(schema[i]=resolve(schema[i]));else for(const key of Object.keys(schema))null!==schema[key]&&"object"==typeof schema[key]&&(schema[key]=resolve(schema[key]))}return schema};return resolve(schema)}function __findPossibleEditorTypes(schema,strayRestrictions=new Map){let rawTypes=new Set;if(schema.type)"string"==typeof schema.type?rawTypes.add(schema.type):Array.isArray(schema.type)&&(rawTypes=new Set(schema.type));else if(schema.enum)for(const entry of schema.enum){const type=typeof entry;let rawType;switch(type){case"bigint":rawType="number";break;case"symbol":case"function":rawType="object";break;case"undefined":rawType="null";break;case"object":rawType=entry?"object":"null";break;default:rawType=type}rawTypes.add(rawType)}const subSchemas=[];schema.anyOf&&subSchemas.push(...schema.anyOf),schema.oneOf&&subSchemas.push(...schema.oneOf);const newStrayRestrictions=new Map;for(const[typename,keywords]of __restrictions)if(!rawTypes.has(typename))for(const keyword of keywords)if(keyword in schema){let restrictionMap=newStrayRestrictions.get(typename);restrictionMap||(restrictionMap=new Map,newStrayRestrictions.set(typename,restrictionMap)),restrictionMap.set(keyword,schema[keyword])}0===rawTypes.size&&0===subSchemas.length&&newStrayRestrictions.size>0&&(rawTypes=new Set(newStrayRestrictions.keys()),newStrayRestrictions.clear());for(const[typename,strayRestriction]of strayRestrictions)if(rawTypes.has(typename)){for(const[keyword,value]of strayRestriction)keyword in schema||(schema[keyword]=value);strayRestrictions.delete(typename)}for(const[typename,strayRestriction]of newStrayRestrictions){const existingStrayRestriction=strayRestrictions.get(typename);if(existingStrayRestriction)for(const[restriction,value]of strayRestriction)existingStrayRestriction.set(restriction,value);else strayRestrictions.set(typename,strayRestriction)}const types=[];for(const rawType of rawTypes){let editorType;if(schema.enum)editorType="enum";else if("date-time"===schema.format||"timespan"===schema.format)editorType="time";else switch(rawType){case"boolean":editorType="boolean";break;case"integer":case"number":editorType="number";break;case"string":editorType="string";break;case"object":editorType="object";break;case"array":editorType=Array.isArray(schema.items)?"tuple":"array";break;case"null":editorType="null";break;default:editorType="invalid"}types.push({editorType,rawType,schema})}if(schema.convert)for(const type of types)type.rawType!==schema.convert&&(type.convert=schema.convert);for(const subSchema of subSchemas){const subTypes=__findPossibleEditorTypes(subSchema,strayRestrictions);types.push(...subTypes)}return types}function __generateName(type,nameGenerator){if(nameGenerator){if("string"==typeof nameGenerator)return nameGenerator;const name=nameGenerator(type.editorType,type.title,type.id,type.condensedFrom.map(type=>type.schema));if(name)return name}return generateName({title:type.title,id:type.id,type:type.editorType})}function generateName(schema){if(schema.title)return schema.title;if(schema.id){const result=/tchmi:([a-zA-Z]+)#\/definitions\/(.+)$/.exec(schema.id);if(result)return result[2]}return"string"==typeof schema.type?schema.type.charAt(0).toUpperCase()+schema.type.slice(1):""}function __createEditorInfo(types,ref,nameGenerator){let info;if(1===types.length)switch(ref.name=__generateName(types[0],nameGenerator),types[0].editorType){case"boolean":info=function(_type,ref){const info=ref;return info.type="boolean",info}(types[0],ref);break;case"number":info=function(type,ref){const restrictions=type.condensedFrom.map(type=>{const restriction={isInteger:"integer"===type.rawType};return void 0!==type.schema.multipleOf&&(restriction.multipleOf=type.schema.multipleOf),void 0!==type.schema.maximum&&(restriction.maximum={value:type.schema.maximum,exclusive:type.schema.exclusiveMaximum??!1}),void 0!==type.schema.minimum&&(restriction.minimum={value:type.schema.minimum,exclusive:type.schema.exclusiveMinimum??!1}),restriction}),info=ref;info.type="number",info.restrictions=restrictions,info.specialValues=new Set;for(const convertible of type.convertibles)if(convertible.schema.enum)for(const item of convertible.schema.enum)info.specialValues.add(item);return info}(types[0],ref);break;case"string":info=function(type,ref){const restrictions=type.condensedFrom.map(type=>{const restriction={};return void 0!==type.schema.minLength&&(restriction.minLength=type.schema.minLength),void 0!==type.schema.maxLength&&(restriction.maxLength=type.schema.maxLength),type.schema.pattern&&(restriction.patterns=[new RegExp(type.schema.pattern)]),type.schema.format&&(restriction.format=type.schema.format),restriction}),info=ref;return info.type="string",info.restrictions=restrictions.filter(restriction=>Object.keys(restriction).length>0),info}(types[0],ref);break;case"time":info=function(type,ref){const formats=new Set(type.condensedFrom.map(type=>type.schema.format).filter(format=>"date-time"===format||"timespan"===format)),info=ref;return info.type="time",info.formats=formats,info}(types[0],ref);break;case"enum":info=function(type,ref){const info=ref;info.type="enum",info.members=new Map;for(const condensedFrom of type.condensedFrom)if(condensedFrom.schema.enum){for(const member of condensedFrom.schema.enum)info.members.set(member,void 0);if(condensedFrom.schema.options)for(const option of condensedFrom.schema.options)info.members.has(option.value)&&info.members.set(option.value,option.label)}return info}(types[0],ref);break;case"object":info=function(type,ref,nameGenerator){const info=ref;info.type="object",info.properties=new Map,info.additionalProperties={allowed:!0};const editorSchema=type.condensedFrom[0].schema;if(editorSchema.patternProperties){info.patternProperties=new Map;for(const[key,property]of Object.entries(editorSchema.patternProperties))info.patternProperties.set(new RegExp(key),__parse(property,"function"==typeof nameGenerator?nameGenerator:void 0))}const buildDefaultValue=!info.defaultValue;if(editorSchema.properties)for(const[key,property]of Object.entries(editorSchema.properties)){let editorInfo=__parse(property,"function"==typeof nameGenerator?nameGenerator:void 0);if(info.patternProperties&&Array.from(info.patternProperties.keys()).some(regex=>regex.test(key))){const matchingInfos=[];for(const[regex,patternInfo]of info.patternProperties)regex.test(key)&&matchingInfos.push(patternInfo);editorInfo=mergeEditorInfos(editorInfo,...matchingInfos)}const propertyMeta=editorSchema.propertiesMeta?.find(meta=>meta.name===key);editorSchema.required?.includes(key)||"optional"===editorInfo.type||(editorInfo={type:"optional",schema:editorInfo.schema,name:editorInfo.name,editorInfo,temporarilyRequired:!1},void 0!==propertyMeta?.defaultValueInternal&&null!==propertyMeta.defaultValueInternal&&Helpers.Editor.validate(editorInfo,propertyMeta.defaultValueInternal)&&(editorInfo.valueIfDisabled=propertyMeta.defaultValueInternal)),void 0!==propertyMeta?.defaultValue&&null!==propertyMeta.defaultValue&&Helpers.Editor.validate(editorInfo,propertyMeta.defaultValue)&&(editorInfo.defaultValue=propertyMeta.defaultValue,buildDefaultValue&&(info.defaultValue??={},info.defaultValue[key]=propertyMeta.defaultValue)),info.properties.set(key,editorInfo)}void 0!==editorSchema.additionalProperties&&(info.additionalProperties.allowed=!1!==editorSchema.additionalProperties,info.additionalProperties.allowed&&(info.additionalProperties.editorInfo=__parse("object"==typeof editorSchema.additionalProperties?editorSchema.additionalProperties:{},"function"==typeof nameGenerator?nameGenerator:void 0)));if(editorSchema.required){info.defaultValue??={};for(const requiredProperty of editorSchema.required){let propertyInfo=info.properties.get(requiredProperty);propertyInfo||(propertyInfo=Helpers.ObjectEditor.getEditorInfoForProperty(info,requiredProperty),info.properties.set(requiredProperty,propertyInfo)),buildDefaultValue&&(info.defaultValue[requiredProperty]=propertyInfo.defaultValue)}}void 0!==editorSchema.maxProperties&&(info.maxProperties=editorSchema.maxProperties);void 0!==editorSchema.minProperties&&(info.minProperties=editorSchema.minProperties);if(void 0!==editorSchema.dependencies){info.dependencies=new Map;for(const key in editorSchema.dependencies){const dependency=editorSchema.dependencies[key];if(Array.isArray(dependency)){const dependencyInfo={type:"object",schema:{},name:info.name,properties:new Map,additionalProperties:{allowed:!0}};for(const requiredProperty of dependency){const editorInfo=Helpers.ObjectEditor.getEditorInfoForProperty(info,requiredProperty);"optional"===editorInfo.type?dependencyInfo.properties.set(requiredProperty,editorInfo.editorInfo):info.properties.get(requiredProperty)!==editorInfo&&dependencyInfo.properties.set(requiredProperty,editorInfo)}info.dependencies.set(key,dependencyInfo)}else{const dependencyInfo=__parse(dependency,"function"==typeof nameGenerator?nameGenerator:void 0);"object"===dependencyInfo.type&&info.dependencies.set(key,dependencyInfo)}}}return info}(types[0],ref,nameGenerator);break;case"array":info=function(type,ref,nameGenerator){const editorSchema=type.condensedFrom[0].schema,info=ref;info.type="array",info.items=editorSchema.items&&!Array.isArray(editorSchema.items)?__parse(editorSchema.items,"function"==typeof nameGenerator?nameGenerator:void 0):Helpers.ChoiceEditor.createAnyEditorInfo(),info.uniqueItems=editorSchema.uniqueItems??!1,void 0!==editorSchema.minItems&&(info.minItems=editorSchema.minItems,info.defaultValue??=Array(info.minItems).fill(info.items.defaultValue));void 0!==editorSchema.maxItems&&(info.maxItems=editorSchema.maxItems);return info}(types[0],ref,nameGenerator);break;case"tuple":info=function(type,ref,nameGenerator){const editorSchema=type.condensedFrom[0].schema,info=ref;info.type="tuple",info.items=[],info.additionalItems={allowed:!0},info.uniqueItems=editorSchema.uniqueItems??!1;let buildDefaultValue=!1;void 0!==editorSchema.minItems&&(info.minItems=editorSchema.minItems,buildDefaultValue=!info.defaultValue,info.defaultValue??=[]);void 0!==editorSchema.maxItems&&(info.maxItems=editorSchema.maxItems);if(Array.isArray(editorSchema.items)){const minItems=info.minItems??0;for(let i=0,ii=editorSchema.items.length;i<ii;i++){let editorInfo=__parse(editorSchema.items[i],"function"==typeof nameGenerator?nameGenerator:void 0);i>=minItems?editorInfo={type:"optional",schema:editorInfo.schema,name:editorInfo.name,editorInfo,temporarilyRequired:!1}:buildDefaultValue&&info.defaultValue?.push(editorInfo.defaultValue),info.items.push(editorInfo)}}void 0!==editorSchema.additionalItems&&(info.additionalItems.allowed=!1!==editorSchema.additionalItems,info.additionalItems.allowed&&(info.additionalItems.editorInfo=__parse("object"==typeof editorSchema.additionalItems?editorSchema.additionalItems:{},"function"==typeof nameGenerator?nameGenerator:void 0)));return info}(types[0],ref,nameGenerator);break;case"null":info=function(_type,ref){const info=ref;return info.type="null",info}(types[0],ref);break;default:info=__createAnyEditorInfo(types[0],ref,nameGenerator)}else info=types.length>1?function(types,ref,nameGenerator){const info=ref;info.type="choice",info.name=__generateName({editorType:"choice",id:info.schema.id,title:info.schema.title,condensedFrom:[{editorType:"choice",rawType:"null",schema:info.schema}],convertibles:[]},nameGenerator),info.choices=[];for(const type of types){const choice=__createEditorInfo([type],{type:"invalid",schema:info.schema,name:""},"function"==typeof nameGenerator?nameGenerator:void 0);if("choice"!==choice.type)info.choices.push(choice);else for(const subChoice of choice.choices??Helpers.ChoiceEditor.getAnyChoices())info.choices.push(subChoice)}return info}(types,ref,nameGenerator):__createAnyEditorInfo({editorType:"choice",id:ref.schema.id,title:ref.schema.title??"Any",condensedFrom:[],convertibles:[]},ref,nameGenerator);return void 0!==ref.schema.default&&Helpers.Editor.validate(info,ref.schema.default)&&(ref.defaultValue=ref.schema.default),info}function __createAnyEditorInfo(type,ref,nameGenerator){const schema=ref.schema,info=Helpers.ChoiceEditor.createAnyEditorInfo(ref);return info.schema=schema,info.name=__generateName(type,nameGenerator),info}function mergeEditorInfos(...toMerge){return __mergeEditorInfos(...toMerge.map(editorInfo=>tchmi_clone_object(editorInfo,__cloneEditorInfoOptions)))}function __mergeEditorInfos(...toMerge){let result;const name=toMerge[0]?.name,enumIndex=toMerge.findIndex(info=>"enum"===info.type);if(-1!==enumIndex)result=toMerge.splice(enumIndex,1)[0];else{const nonAnyIndex=toMerge.findIndex(info=>"choice"!==info.type||void 0!==info.choices);result=-1!==nonAnyIndex?toMerge.splice(nonAnyIndex,1)[0]:toMerge.shift()}if(!result)return{type:"invalid",schema:{},name:name??"Invalid"};if(0===(toMerge=toMerge.filter(info=>"choice"!==info.type||void 0!==info.choices)).length)return result;const mergedWithCollection=__mergedEditorInfos.get(result);if(mergedWithCollection){if(mergedWithCollection.some(mergedWith=>mergedWith.length===toMerge.length&&mergedWith.every((info,index)=>info===toMerge[index])))return result;mergedWithCollection.push(toMerge)}else __mergedEditorInfos.set(result,[toMerge]);switch(result.schema={allOf:[result.schema].concat(...toMerge.map(info=>info.schema))},name&&(result.name=name),result.type){case"boolean":return function(target,toMerge){if(!toMerge.every(info=>"boolean"===info.type||"optional"===info.type&&"boolean"===info.editorInfo.type||"choice"===info.type&&(!info.choices||info.choices.some(choice=>"boolean"===choice.type))))return{type:"invalid",schema:target.schema,name:target.name};return target}(result,toMerge);case"number":return function(target,toMerge){toMerge=toMerge.map(info=>{if("optional"===info.type)return info.editorInfo;if("choice"===info.type){const numberChoices=(info.choices??Helpers.ChoiceEditor.getAnyChoices()).filter(choice=>"number"===choice.type);return 0===numberChoices.length?info:1===numberChoices.length?numberChoices[0]:numberChoices.reduce((result,current)=>{for(const specialValue of current.specialValues)result.specialValues.add(specialValue);return result.restrictions.push(...current.restrictions),result})}return info});for(const info of toMerge){if("number"!==info.type)return{type:"invalid",schema:target.schema,name:target.name};if(target.specialValues=new Set([...target.specialValues].filter(value=>info.specialValues.has(value))),info.restrictions.length>0)if(0===target.restrictions.length)target.restrictions=tchmi_clone_object(info.restrictions,__cloneEditorInfoOptions);else{const restrictions=[];for(const targetRestriction of target.restrictions)for(const mergeRestriction of info.restrictions){const restriction={isInteger:targetRestriction.isInteger||mergeRestriction.isInteger};let isValid=!0;void 0!==targetRestriction.multipleOf&&void 0!==mergeRestriction.multipleOf?restriction.multipleOf=targetRestriction.multipleOf===mergeRestriction.multipleOf?targetRestriction.multipleOf:targetRestriction.multipleOf*mergeRestriction.multipleOf:void 0!==targetRestriction.multipleOf?restriction.multipleOf=targetRestriction.multipleOf:void 0!==mergeRestriction.multipleOf&&(restriction.multipleOf=mergeRestriction.multipleOf),targetRestriction.maximum&&mergeRestriction.maximum?targetRestriction.maximum.value<mergeRestriction.maximum.value?restriction.maximum=targetRestriction.maximum:mergeRestriction.maximum.value<targetRestriction.maximum.value?restriction.maximum=mergeRestriction.maximum:restriction.maximum={value:targetRestriction.maximum.value,exclusive:targetRestriction.maximum.exclusive||mergeRestriction.maximum.exclusive}:targetRestriction.maximum?restriction.maximum=targetRestriction.maximum:mergeRestriction.maximum&&(restriction.maximum=mergeRestriction.maximum),targetRestriction.minimum&&mergeRestriction.minimum?targetRestriction.minimum.value>mergeRestriction.minimum.value?restriction.minimum=targetRestriction.minimum:mergeRestriction.minimum.value>targetRestriction.minimum.value?restriction.minimum=mergeRestriction.minimum:restriction.minimum={value:targetRestriction.minimum.value,exclusive:targetRestriction.minimum.exclusive||mergeRestriction.minimum.exclusive}:targetRestriction.minimum?restriction.minimum=targetRestriction.minimum:mergeRestriction.minimum&&(restriction.minimum=mergeRestriction.minimum),restriction.maximum&&restriction.minimum&&(restriction.maximum.value<restriction.minimum.value||restriction.maximum.value===restriction.minimum.value&&(restriction.maximum.exclusive||restriction.minimum.exclusive))&&(isValid=!1),isValid&&!restrictions.some(r=>tchmi_equal(r,restriction,__compareEditorInfoOptions))&&restrictions.push(restriction)}if(!(restrictions.length>0))return{type:"invalid",schema:target.schema,name:target.name};target.restrictions=restrictions}}return target}(result,toMerge);case"string":return function(target,toMerge){toMerge=toMerge.map(info=>{if("optional"===info.type)return info.editorInfo;if("choice"===info.type){const stringChoices=(info.choices??Helpers.ChoiceEditor.getAnyChoices()).filter(choice=>"string"===choice.type);return 0===stringChoices.length?info:1===stringChoices.length?stringChoices[0]:stringChoices.reduce((result,current)=>(result.restrictions.push(...current.restrictions),result))}return info});for(const info of toMerge){if("string"!==info.type)return{type:"invalid",schema:target.schema,name:target.name};if(info.restrictions.length>0)if(0===target.restrictions.length)target.restrictions=tchmi_clone_object(info.restrictions,__cloneEditorInfoOptions);else{const restrictions=[];for(const targetRestriction of target.restrictions)for(const mergeRestriction of info.restrictions){const restriction={};let isValid=!0;targetRestriction.patterns&&mergeRestriction.patterns?restriction.patterns=targetRestriction.patterns.concat(mergeRestriction.patterns):targetRestriction.patterns?restriction.patterns=tchmi_clone_object(targetRestriction.patterns,__cloneEditorInfoOptions):mergeRestriction.patterns&&(restriction.patterns=tchmi_clone_object(mergeRestriction.patterns,__cloneEditorInfoOptions)),targetRestriction.format&&mergeRestriction.format?targetRestriction.format===mergeRestriction.format?restriction.format=targetRestriction.format:isValid=!1:targetRestriction.format?restriction.format=targetRestriction.format:mergeRestriction.format&&(restriction.format=mergeRestriction.format),void 0!==targetRestriction.maxLength&&void 0!==mergeRestriction.maxLength?restriction.maxLength=Math.min(targetRestriction.maxLength,mergeRestriction.maxLength):void 0!==targetRestriction.maxLength?restriction.maxLength=targetRestriction.maxLength:void 0!==mergeRestriction.maxLength&&(restriction.maxLength=mergeRestriction.maxLength),void 0!==targetRestriction.minLength&&void 0!==mergeRestriction.minLength?restriction.minLength=Math.max(targetRestriction.minLength,mergeRestriction.minLength):void 0!==targetRestriction.minLength?restriction.minLength=targetRestriction.minLength:void 0!==mergeRestriction.minLength&&(restriction.minLength=mergeRestriction.minLength),void 0!==restriction.maxLength&&void 0!==restriction.minLength&&restriction.maxLength<restriction.minLength&&(isValid=!1),isValid&&!restrictions.some(r=>tchmi_equal(r,restriction,__compareEditorInfoOptions))&&restrictions.push(restriction)}if(!(restrictions.length>0))return{type:"invalid",schema:target.schema,name:target.name};target.restrictions=restrictions}}return target}(result,toMerge);case"time":return function(target,toMerge){toMerge=toMerge.map(info=>{if("optional"===info.type)return info.editorInfo;if("choice"===info.type){const timeChoices=(info.choices??Helpers.ChoiceEditor.getAnyChoices()).filter(choice=>"time"===choice.type);return 0===timeChoices.length?info:1===timeChoices.length?timeChoices[0]:timeChoices.reduce((result,current)=>{for(const format of current.formats)result.formats.add(format);return result})}return info});for(const info of toMerge){if("time"!==info.type)return{type:"invalid",schema:target.schema,name:target.name};if(target.formats=new Set([...target.formats].filter(value=>info.formats.has(value))),0===target.formats.size)return{type:"invalid",schema:target.schema,name:target.name}}return target}(result,toMerge);case"enum":return function(target,toMerge){toMerge=toMerge.map(info=>"optional"!==info.type?info:info.editorInfo);for(const info of toMerge){if("enum"===info.type)for(const member of target.members.keys())info.members.has(member)?target.members.set(member,info.members.get(member)):target.members.delete(member);else for(const member of target.members.keys())Helpers.Editor.validate(info,member)||target.members.delete(member);if(0===target.members.size)return{type:"invalid",schema:target.schema,name:target.name}}return target}(result,toMerge);case"object":return function(target,toMerge){const reduced=new Set,reduceObjectEditors=(result,current)=>{if(reduced.has(result))return result;if(reduced.add(result),result.additionalProperties.allowed=result.additionalProperties.allowed||current.additionalProperties.allowed,current.additionalProperties.editorInfo&&(result.additionalProperties.editorInfo?("choice"!==result.additionalProperties.editorInfo.type&&(result.additionalProperties.editorInfo={type:"choice",schema:{},name:"Choice",choices:[result.additionalProperties.editorInfo]}),"choice"===current.additionalProperties.editorInfo.type?current.additionalProperties.editorInfo.choices?result.additionalProperties.editorInfo.choices?.push(...current.additionalProperties.editorInfo.choices):delete result.additionalProperties.editorInfo.choices:result.additionalProperties.editorInfo.choices?.push(current.additionalProperties.editorInfo)):result.additionalProperties.editorInfo=current.additionalProperties.editorInfo),current.patternProperties){result.patternProperties||(result.patternProperties=new Map);for(const[regex,propertyInfo]of current.patternProperties){let resultKey=null,resultValue=propertyInfo;for(const[resultRegex,resultPropertyInfo]of result.patternProperties)if(regex.source===resultRegex.source){resultKey=resultRegex,resultValue="choice"!==resultPropertyInfo.type?{type:"choice",schema:{},name:"Choice",choices:[resultPropertyInfo]}:resultPropertyInfo,"choice"===propertyInfo.type?propertyInfo.choices?resultValue.choices?.push(...propertyInfo.choices):delete resultValue.choices:resultValue.choices?.push(propertyInfo);break}null===resultKey&&(resultKey=regex),result.patternProperties.set(resultKey,resultValue)}}const propertiesToMakeOptional=new Set(result.properties.keys());for(const[name,propertyInfo]of current.properties){let resultValue=result.properties.get(name);resultValue?(propertiesToMakeOptional.delete(name),"choice"!==resultValue.type&&(resultValue={type:"choice",schema:{},name:"Choice",choices:[resultValue]}),"choice"===propertyInfo.type?propertyInfo.choices?resultValue.choices?.push(...propertyInfo.choices):delete resultValue.choices:resultValue.choices?.push(propertyInfo)):(resultValue=propertyInfo,"optional"!==resultValue.type&&(resultValue={type:"optional",schema:{},name:resultValue.name,editorInfo:resultValue,temporarilyRequired:!1})),result.properties.set(name,resultValue)}for(const name of propertiesToMakeOptional){let resultValue=result.properties.get(name);resultValue&&("optional"!==resultValue.type&&(resultValue={type:"optional",schema:{},name:resultValue.name,editorInfo:resultValue,temporarilyRequired:!1},result.properties.set(name,resultValue)))}if(result.dependencies)if(current.dependencies){const dependenciesToDelete=new Set(result.dependencies.keys());for(const[name,dependency]of current.dependencies){let resultValue=result.dependencies.get(name);resultValue&&(dependenciesToDelete.delete(name),resultValue=reduceObjectEditors(resultValue,dependency),result.dependencies.set(name,resultValue))}for(const name of dependenciesToDelete)result.dependencies.delete(name)}else delete result.dependencies;return void 0!==result.minProperties&&(void 0===current.minProperties?delete result.minProperties:result.minProperties=Math.min(current.minProperties,result.minProperties)),void 0!==result.maxProperties&&(void 0===current.maxProperties?delete result.maxProperties:result.maxProperties=Math.max(current.maxProperties,result.maxProperties)),result};toMerge=toMerge.map(info=>{if("optional"===info.type)return info.editorInfo;if("choice"===info.type){const objectChoices=(info.choices??Helpers.ChoiceEditor.getAnyChoices()).filter(choice=>"object"===choice.type);return 0===objectChoices.length?info:1===objectChoices.length?objectChoices[0]:objectChoices.reduce(reduceObjectEditors)}return info});for(const info of toMerge){if("object"!==info.type)return{type:"invalid",schema:target.schema,name:target.name};if(!info.additionalProperties.allowed)for(const name of target.properties.keys())if(!(info.properties.has(name)||info.patternProperties&&Array.from(info.patternProperties.keys()).some(regex=>regex.test(name))))return{type:"invalid",schema:target.schema,name:target.name};if(info.patternProperties){target.patternProperties||(target.patternProperties=new Map);for(const[regex,mergePropertyInfo]of info.patternProperties){let foundTarget=!1;for(const[targetRegex,targetPropertyInfo]of target.patternProperties)if(targetRegex.source===regex.source){foundTarget=!0,target.patternProperties.set(targetRegex,__mergeEditorInfos(targetPropertyInfo,mergePropertyInfo));break}foundTarget||target.patternProperties.set(regex,mergePropertyInfo);for(const[targetName,targetPropertyInfo]of target.properties)regex.test(targetName)&&target.properties.set(targetName,__mergeEditorInfos(targetPropertyInfo,mergePropertyInfo))}}if(info.additionalProperties.editorInfo)for(const[name,targetPropertyInfo]of target.properties)info.properties.has(name)||info.patternProperties&&Array.from(info.patternProperties.keys()).some(regex=>regex.test(name))||target.properties.set(name,__mergeEditorInfos(targetPropertyInfo,info.additionalProperties.editorInfo));for(const[name,mergePropertyInfo]of info.properties){const targetPropertyInfo=Helpers.ObjectEditor.getEditorInfoForProperty(target,name);if("invalid"===targetPropertyInfo.type)return{type:"invalid",schema:target.schema,name:target.name};target.properties.set(name,__mergeEditorInfos(targetPropertyInfo,mergePropertyInfo))}if(target.additionalProperties.allowed=target.additionalProperties.allowed&&info.additionalProperties.allowed,target.additionalProperties.allowed?target.additionalProperties.editorInfo&&info.additionalProperties.editorInfo?target.additionalProperties.editorInfo=__mergeEditorInfos(target.additionalProperties.editorInfo,info.additionalProperties.editorInfo):info.additionalProperties.editorInfo&&(target.additionalProperties.editorInfo=info.additionalProperties.editorInfo):target.additionalProperties.editorInfo&&delete target.additionalProperties.editorInfo,void 0!==info.maxProperties&&(void 0!==target.maxProperties?target.maxProperties=Math.min(target.maxProperties,info.maxProperties):target.maxProperties=info.maxProperties),void 0!==info.minProperties&&(void 0!==target.minProperties?target.minProperties=Math.max(target.minProperties,info.minProperties):target.minProperties=info.minProperties),info.dependencies)if(target.dependencies)for(const[name,mergeDependency]of info.dependencies){const targetDependency=target.dependencies.get(name);if(targetDependency){const dependency=__mergeEditorInfos(targetDependency,mergeDependency);if("object"!==dependency.type)return{type:"invalid",schema:target.schema,name:target.name};target.dependencies.set(name,dependency)}else target.dependencies.set(name,mergeDependency)}else target.dependencies=info.dependencies}if(void 0!==target.minProperties&&void 0!==target.maxProperties&&target.minProperties>target.maxProperties)return{type:"invalid",schema:target.schema,name:target.name};return target}(result,toMerge);case"array":return function(target,toMerge){toMerge=toMerge.map(info=>{if("optional"===info.type)return info.editorInfo;if("choice"===info.type){const arrayChoices=(info.choices??Helpers.ChoiceEditor.getAnyChoices()).filter(choice=>"array"===choice.type);return 0===arrayChoices.length?info:1===arrayChoices.length?arrayChoices[0]:arrayChoices.reduce((result,current)=>("choice"!==result.items.type&&(result.items={type:"choice",schema:{},name:"Choice",choices:[result.items]}),"choice"===current.items.type?current.items.choices?result.items.choices?.push(...current.items.choices):delete result.items.choices:result.items.choices?.push(current.items),void 0!==result.minItems&&(void 0===current.minItems?delete result.minItems:result.minItems=Math.min(current.minItems,result.minItems)),void 0!==result.maxItems&&(void 0===current.maxItems?delete result.maxItems:result.maxItems=Math.max(current.maxItems,result.maxItems)),result.uniqueItems=result.uniqueItems&&current.uniqueItems,result))}return info});const itemInfos=[target.items];for(const info of toMerge){if("array"!==info.type)return{type:"invalid",schema:target.schema,name:target.name};void 0!==info.minItems&&(void 0===target.minItems||target.minItems<info.minItems)&&(target.minItems=info.minItems),void 0!==info.maxItems&&(void 0===target.maxItems||target.maxItems>info.maxItems)&&(target.maxItems=info.maxItems),target.uniqueItems=target.uniqueItems||info.uniqueItems,itemInfos.push(info.items)}if(void 0!==target.minItems&&void 0!==target.maxItems&&target.minItems>target.maxItems)return{type:"invalid",schema:target.schema,name:target.name};if(target.items=__mergeEditorInfos(...itemInfos),"invalid"===target.items.type)return{type:"invalid",schema:target.schema,name:target.name};return target}(result,toMerge);case"tuple":return function(target,toMerge){toMerge=toMerge.map(info=>{if("optional"===info.type)return info.editorInfo;if("choice"===info.type){const tupleChoices=(info.choices??Helpers.ChoiceEditor.getAnyChoices()).filter(choice=>"tuple"===choice.type);return 0===tupleChoices.length?info:1===tupleChoices.length?tupleChoices[0]:tupleChoices.reduce((result,current)=>{result.additionalItems.allowed=result.additionalItems.allowed||current.additionalItems.allowed,result.additionalItems.editorInfo&&(current.additionalItems.editorInfo?("choice"!==result.additionalItems.editorInfo.type&&(result.additionalItems.editorInfo={type:"choice",schema:{},name:"Choice",choices:[result.additionalItems.editorInfo]}),"choice"===current.additionalItems.editorInfo.type?current.additionalItems.editorInfo.choices?result.additionalItems.editorInfo.choices?.push(...current.additionalItems.editorInfo.choices):delete result.additionalItems.editorInfo.choices:result.additionalItems.editorInfo.choices?.push(current.additionalItems.editorInfo)):delete result.additionalItems.editorInfo);const itemsToMakeOptional=new Set(result.items.keys());for(const[index,itemInfo]of current.items.entries()){let resultValue=result.items[index];resultValue?(itemsToMakeOptional.delete(index),"choice"!==resultValue.type&&(resultValue={type:"choice",schema:{},name:"Choice",choices:[resultValue]}),"choice"===itemInfo.type?itemInfo.choices?resultValue.choices?.push(...itemInfo.choices):delete resultValue.choices:resultValue.choices?.push(itemInfo)):(resultValue=itemInfo,"optional"!==resultValue.type&&(resultValue={type:"optional",schema:{},name:resultValue.name,editorInfo:resultValue,temporarilyRequired:!1})),result.items[index]=resultValue}for(const index of itemsToMakeOptional){let resultValue=result.items[index];resultValue&&("optional"!==resultValue.type&&(resultValue={type:"optional",schema:{},name:resultValue.name,editorInfo:resultValue,temporarilyRequired:!1},result.items[index]=resultValue))}return void 0!==result.minItems&&(void 0===current.minItems?delete result.minItems:result.minItems=Math.min(current.minItems,result.minItems)),void 0!==result.maxItems&&(void 0===current.maxItems?delete result.maxItems:result.maxItems=Math.max(current.maxItems,result.maxItems)),result.uniqueItems=result.uniqueItems&&current.uniqueItems,result})}return info});for(const info of toMerge){if("tuple"!==info.type)return{type:"invalid",schema:target.schema,name:target.name};let index=0;for(const length=target.items.length;index<length;index++){if(index<info.items.length)target.items[index]=__mergeEditorInfos(target.items[index],info.items[index]);else{if(!info.additionalItems.allowed)return{type:"invalid",schema:target.schema,name:target.name};info.additionalItems.editorInfo&&(target.items[index]=__mergeEditorInfos(target.items[index],info.additionalItems.editorInfo))}if("invalid"===target.items[index].type)return{type:"invalid",schema:target.schema,name:target.name}}for(const length=info.items.length;index<length;index++){if(!target.additionalItems.allowed)return{type:"invalid",schema:target.schema,name:target.name};if(target.additionalItems.editorInfo){if(target.items[index]=__mergeEditorInfos(target.additionalItems.editorInfo,info.items[index]),"invalid"===target.items[index].type)return{type:"invalid",schema:target.schema,name:target.name}}else target.items[index]=info.items[index]}target.additionalItems.allowed=target.additionalItems.allowed&&info.additionalItems.allowed,target.additionalItems.allowed?target.additionalItems.editorInfo&&info.additionalItems.editorInfo?target.additionalItems.editorInfo=__mergeEditorInfos(target.additionalItems.editorInfo,info.additionalItems.editorInfo):info.additionalItems.editorInfo&&(target.additionalItems.editorInfo=info.additionalItems.editorInfo):target.additionalItems.editorInfo&&delete target.additionalItems.editorInfo,void 0!==info.minItems&&(void 0===target.minItems||target.minItems<info.minItems)&&(target.minItems=info.minItems),void 0!==info.maxItems&&(void 0===target.maxItems||target.maxItems>info.maxItems)&&(target.maxItems=info.maxItems),target.uniqueItems=target.uniqueItems||info.uniqueItems}if(void 0!==target.minItems&&void 0!==target.maxItems&&target.minItems>target.maxItems)return{type:"invalid",schema:target.schema,name:target.name};return target}(result,toMerge);case"choice":return function(target,toMerge){function boolToNum(value){return value?1:0}function findValidMerge(choice,candidates){const mergeOrder=Array.from(candidates).sort((a,b)=>{const aVal=(boolToNum(a.name===choice.name)<<1)+boolToNum(a.type===choice.type);return(boolToNum(b.name===choice.name)<<1)+boolToNum(b.type===choice.type)-aVal});for(const mergeChoice of mergeOrder){const mergeResult=__mergeEditorInfos(choice,mergeChoice);if("invalid"!==mergeResult.type&&"choice"!==mergeResult.type)return{validCandidate:mergeChoice,mergedInfo:mergeResult}}return null}toMerge=toMerge.map(info=>"optional"!==info.type?info:info.editorInfo);for(const info of toMerge){const mergeChoices=new Set("choice"===info.type?info.choices??Helpers.ChoiceEditor.getAnyChoices():[info]),missingChoices=new Set(mergeChoices),originalChoices=new Set(target.choices?.map(choice=>tchmi_clone_object(choice,__cloneEditorInfoOptions)));target.choices||(target.choices=Helpers.ChoiceEditor.getAnyChoices());for(let i=0;i<target.choices.length;i++){const mergeResult=findValidMerge(target.choices[i],mergeChoices);mergeResult?(target.choices[i]=mergeResult.mergedInfo,missingChoices.delete(mergeResult.validCandidate)):(target.choices.splice(i,1),i--)}for(const choice of missingChoices){const mergeResult=findValidMerge(choice,originalChoices);mergeResult&&target.choices.push(mergeResult.mergedInfo)}}return target}(result,toMerge);case"optional":return function(target,toMerge){let temporarilyRequired=!1;const unwrappedInfos=toMerge.map(info=>"optional"===info.type?(info.temporarilyRequired&&(temporarilyRequired=!0),info.editorInfo):(temporarilyRequired=!0,info)),merged=__mergeEditorInfos(target.editorInfo,...unwrappedInfos);return target.editorInfo="optional"!==merged.type?merged:merged.editorInfo,target.temporarilyRequired=temporarilyRequired,target}(result,toMerge);case"null":return function(target,toMerge){if(toMerge=toMerge.map(info=>"optional"!==info.type?info:info.editorInfo),!toMerge.every(info=>"null"===info.type))return{type:"invalid",schema:target.schema,name:target.name};return target}(result,toMerge);case"invalid":return result}}SchemaParser.parse=function(schema,nameGenerator){return __parse(resolveReferences(schema),nameGenerator)},SchemaParser.resolveAllOf=function(schema){const resolvedSchemas=new Set;return function resolve(schema){if(resolvedSchemas.has(schema))return schema;if(resolvedSchemas.add(schema),null!==schema&&"object"==typeof schema){if(schema.allOf&&Array.isArray(schema.allOf))return schema.allOf.reduce((combined,current)=>{for(const key of Object.keys(current)){if(void 0!==combined[key]&&!tchmi_equal(combined[key],current[key]))throw new Error(`This method cannot resolve conflicting JSON schema properties. Property "${key}" is present in both schemas with conflicting values ${JSON.stringify(combined[key])} and ${JSON.stringify(current[key])}`);combined[key]=current[key]}return combined});if(Array.isArray(schema))for(const[index,subSchema]of schema.entries())null!==subSchema&&"object"==typeof subSchema&&(schema[index]=resolve(subSchema));else for(const[key,subSchema]of Object.entries(schema))null!==subSchema&&"object"==typeof subSchema&&(schema[key]=resolve(subSchema))}return schema}(tchmi_clone_object(schema,__cloneEditorInfoOptions))},SchemaParser.resolveReferences=resolveReferences,SchemaParser.generateName=generateName,SchemaParser.mergeEditorInfos=mergeEditorInfos,SchemaParser.editorInfoEquivalent=function(a,b){for(const key of Object.keys(a))if("schema"!==key&&!tchmi_equal(a[key],b[key],__compareEditorInfoOptions))return!1;return!0}}(SchemaParser=Helpers.SchemaParser||(Helpers.SchemaParser={}))}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){class Editor{__element;__editorInfo;__factory;static#tchmiFQN="TcHmi.Controls.Helpers."+this.name;__parentControl;__name;__className="TcHmi_Controls_Helpers_Editor";__childControls=new Set;__eventDestroyers=[];__isEnabled=!0;__visibility="Visible";__isReadOnly=!1;__settings={};__localizations={optionalEditor:{optionalCheckboxTooltip:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Checkbox_Tooltip_Optional%/l%"},booleanEditor:{falseText:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Combobox_Text_False%/l%",trueText:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Combobox_Text_True%/l%"},buttonBasedEditor:{buttonTooltip:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Button_Tooltip_Open%/l%"},timeEditor:{dateTimeButtonTooltip:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Button_Tooltip_DateTime%/l%",timespanButtonTooltip:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Button_Tooltip_Timespan%/l%"},choiceEditor:{comboboxText:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Combobox_Text_ChooseType%/l%"},invalidEditor:{invalidSchemaText:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Invalid_Schema_Text%/l%"},arrayBasedEditorPane:{addButtonTooltip:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Button_Tooltip_AddItem%/l%",removeButtonTooltip:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Button_Tooltip_RemoveItem%/l%",upButtonTooltip:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Button_Tooltip_ItemUp%/l%",downButtonTooltip:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Button_Tooltip_ItemDown%/l%"},objectEditorPane:{addButtonTooltip:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Button_Tooltip_AddProperty%/l%",acceptButtonText:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Button_Text_OK%/l%",acceptButtonTooltip:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Button_Tooltip_AcceptProperty%/l%",cancelButtonTooltip:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Button_Tooltip_CancelProperty%/l%",removeButtonTooltip:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Button_Tooltip_RemoveProperty%/l%"},editorPrompt:{buttonTextOk:"%l%Framework::Popup_Button_Text_OK%/l%",buttonTooltipOk:"%l%Framework::Popup_Button_Tooltip_OK%/l%",buttonTextCancel:"%l%Framework::Popup_Button_Text_Cancel%/l%",buttonTooltipCancel:"%l%Framework::Popup_Button_Tooltip_Cancel%/l%"},errors:{[Editor.Error.ERROR]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_Error%/l%",[Editor.Error.FAILS_ALL_RESTRICTIONS]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_FailsAllRestrictions%/l%",[Editor.Error.FAILS_THIS_RESTRICTION]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_FailsThisRestriction%/l%",[Editor.Error.TYPE_ERROR]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_TypeError%/l%",[Editor.Error.NOT_A_BOOLEAN]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_NotABoolean%/l%",[Editor.Error.NOT_A_NUMBER]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_NotANumber%/l%",[Editor.Error.NOT_A_STRING]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_NotAString%/l%",[Editor.Error.NOT_AN_OBJECT]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_NotAnObject%/l%",[Editor.Error.NOT_AN_ARRAY]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_NotAnArray%/l%",[Editor.Error.NOT_NULL]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_NotNull%/l%",[Editor.Error.NUMBER_TOO_SMALL]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_NumberTooSmall%/l%",[Editor.Error.NUMBER_TOO_BIG]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_NumberTooBig%/l%",[Editor.Error.NUMBER_NOT_MULTIPLE_OF]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_NumberNotMultipleOf%/l%",[Editor.Error.NUMBER_NOT_INTEGER]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_NumberNotInteger%/l%",[Editor.Error.NUMBER_NOT_FINITE]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_NumberNotFinite%/l%",[Editor.Error.STRING_TOO_SHORT]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_StringTooShort%/l%",[Editor.Error.STRING_TOO_LONG]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_StringTooLong%/l%",[Editor.Error.STRING_DOES_NOT_MATCH]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_StringDoesNotMatch%/l%",[Editor.Error.STRING_NOT_DATE_TIME]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_StringNotDateTime%/l%",[Editor.Error.STRING_NOT_TIMESPAN]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_StringNotTimespan%/l%",[Editor.Error.STRING_NOT_EMAIL]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_StringNotEmail%/l%",[Editor.Error.STRING_NOT_HOSTNAME]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_StringNotHostname%/l%",[Editor.Error.STRING_NOT_IPV4]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_StringNotIPv4%/l%",[Editor.Error.STRING_NOT_IPV6]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_StringNotIPv6%/l%",[Editor.Error.STRING_NOT_URI]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_StringNotURI%/l%",[Editor.Error.OBJECT_HAS_TOO_FEW_PROPERTIES]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_ObjectHasTooFewProperties%/l%",[Editor.Error.OBJECT_HAS_TOO_MANY_PROPERTIES]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_ObjectHasTooManyProperties%/l%",[Editor.Error.OBJECT_IS_MISSING_PROPERTY]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_ObjectIsMissingProperty%/l%",[Editor.Error.OBJECT_CONTAINS_INVALID_PROPERTY_NAME]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_ObjectContainsInvalidPropertyName%/l%",[Editor.Error.OBJECT_CONTAINS_INVALID_VALUE]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_ObjectContainsInvalidValue%/l%",[Editor.Error.OBJECT_HAS_INVALID_PROTOTYPE]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_ObjectHasInvalidPrototype%/l%",[Editor.Error.OBJECT_HAS_INVALID_DEPENDENCY]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_ObjectHasInvalidDependency%/l%",[Editor.Error.ARRAY_HAS_TOO_FEW_ITEMS]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_ArrayHasTooFewItems%/l%",[Editor.Error.ARRAY_HAS_TOO_MANY_ITEMS]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_ArrayHasTooManyItems%/l%",[Editor.Error.ARRAY_CONTAINS_INVALID_VALUE]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_ArrayContainsInvalidValue%/l%",[Editor.Error.ARRAY_CONTAINS_DUPLICATE_ITEMS]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_ArrayContainsDuplicateItems%/l%",[Editor.Error.ARRAY_HAS_INVALID_PROTOTYPE]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_ArrayHasInvalidPrototype%/l%",[Editor.Error.ENUM_VALUE_NOT_A_MEMBER]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_EnumValueNotAMember%/l%",[Editor.Error.DOES_NOT_FIT_ANY_CHOICE]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_DoesNotFitAnyChoice%/l%",[Editor.Error.DOES_NOT_FIT_THIS_CHOICE]:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Error_DoesNotFitThisChoice%/l%"}};__localizationSymbols=new Map;__onChangeManager=new Helpers.CallbackManager;onChange=this.__onChangeManager.getManipulators();__onConfirmManager=new Helpers.CallbackManager;onConfirm=this.__onConfirmManager.getManipulators();constructor(__element,__editorInfo,__factory){if(this.__element=__element,this.__editorInfo=__editorInfo,this.__factory=__factory,this.__parentControl=this.__factory.parentControl,this.__parentControl){this.__name=`${this.__parentControl.getId()}.${this.constructor.name}-${tchmi_create_guid()}`;const controlClass=this.__parentControl.getType().replace(/\./g,"_");__element.classList.add(this.__className,`${this.__className}-${this.constructor.name}`,`${controlClass}-editor`)}else this.__name=`${this.constructor.name}-${tchmi_create_guid()}`,__element.classList.add(this.__className,`${this.__className}-${this.constructor.name}`)}static create(element,editorInfo,parentControl,localizations){return new Helpers.EditorFactory({parentControl,texts:localizations}).fromEditorInfo(editorInfo,element)}destroy(){for(const destroy of this.__eventDestroyers)destroy();this.__eventDestroyers=[];for(const control of this.__childControls)this.__parentControl&&this.__parentControl.__removeChild(control),control.destroy();this.__childControls.clear();for(const entry of this.__localizationSymbols.values())entry.destroyWatch(),entry.symbol.destroy();this.__localizationSymbols.clear()}setEditorInfo(editorInfo){const oldState=this.getState();let changeHandlersTriggered=!1;const detectChangeHandlersTriggered=()=>{changeHandlersTriggered=!0};this.onChange.add(detectChangeHandlersTriggered),this.__editorInfo=editorInfo,this.__processEditorInfo(),this.onChange.remove(detectChangeHandlersTriggered);const newState=this.getState();changeHandlersTriggered||tchmi_equal(oldState,newState)||this.__onChangeManager.trigger(this,newState)}getEditorInfo(){return this.__editorInfo}getState(){const value=this.getRawValue(),errors=Editor.checkForErrors(this.__editorInfo,value);return 0===errors.length?{isValid:!0,value}:{isValid:!1,errors}}static validate(editorInfo,value){switch(editorInfo.type){case"boolean":return Helpers.BooleanEditor.validate(editorInfo,value);case"number":return Helpers.NumberEditor.validate(editorInfo,value);case"string":return Helpers.StringEditor.validate(editorInfo,value);case"time":return Helpers.TimeEditor.validate(editorInfo,value);case"enum":return Helpers.EnumEditor.validate(editorInfo,value);case"object":return Helpers.ObjectEditor.validate(editorInfo,value);case"array":return Helpers.ArrayEditor.validate(editorInfo,value);case"tuple":return Helpers.TupleEditor.validate(editorInfo,value);case"optional":return Helpers.OptionalEditor.validate(editorInfo,value);case"choice":return Helpers.ChoiceEditor.validate(editorInfo,value);case"null":return Helpers.NullEditor.validate(editorInfo,value);case"invalid":return Helpers.InvalidEditor.validate(editorInfo,value)}}static checkForErrors(editorInfo,value,returnEarly=!1){switch(editorInfo.type){case"boolean":return Helpers.BooleanEditor.checkForErrors(editorInfo,value,returnEarly);case"number":return Helpers.NumberEditor.checkForErrors(editorInfo,value,returnEarly);case"string":return Helpers.StringEditor.checkForErrors(editorInfo,value,returnEarly);case"time":return Helpers.TimeEditor.checkForErrors(editorInfo,value,returnEarly);case"enum":return Helpers.EnumEditor.checkForErrors(editorInfo,value,returnEarly);case"object":return Helpers.ObjectEditor.checkForErrors(editorInfo,value,returnEarly);case"array":return Helpers.ArrayEditor.checkForErrors(editorInfo,value,returnEarly);case"tuple":return Helpers.TupleEditor.checkForErrors(editorInfo,value,returnEarly);case"optional":return Helpers.OptionalEditor.checkForErrors(editorInfo,value,returnEarly);case"choice":return Helpers.ChoiceEditor.checkForErrors(editorInfo,value,returnEarly);case"null":return Helpers.NullEditor.checkForErrors(editorInfo,value,returnEarly);case"invalid":return Helpers.InvalidEditor.checkForErrors(editorInfo,value,returnEarly)}}setIsEnabled(isEnabled){this.__isEnabled=isEnabled,this.__element.classList.toggle("disabled",!isEnabled);for(const control of this.__childControls)control.setIsEnabled(isEnabled);isEnabled&&this.__processIsReadOnly()}getIsEnabled(){return this.__isEnabled}setVisibility(visibility){this.__visibility=visibility,this.__element.style.visibility=visibility.toLowerCase();for(const control of this.__childControls)control.setVisibility(visibility)}getVisibility(){return this.__visibility}setIsReadOnly(isReadOnly){this.__isReadOnly=isReadOnly,this.__element.classList.toggle("read-only",isReadOnly),this.__processIsReadOnly()}getIsReadOnly(){return this.__isReadOnly}setSettings(settings){for(const[editor,subSettings]of Object.entries(settings))this.__settings[editor]=subSettings}getSettings(){return this.__settings}__buildValidationMessage(state,maxDepth=1/0){if(state.isValid)return"";const buildMessage=(detail,maxDepth,indentation="")=>{let message,text=this.__localizations?.errors?.[detail.error];if(text?(TcHmi.Symbol.isSymbolExpression(text)&&(text=new TcHmi.Symbol(text).read()??Editor.Error[detail.error]),detail.parameters?.length&&(text=tchmi_format_string(text,...detail.parameters)),message=indentation+text):message=indentation+Editor.Error[detail.error],detail.underlying&&maxDepth>1)for(const underlying of detail.underlying)message+="\n"+buildMessage(underlying,maxDepth-1,indentation+"    ");return message};return state.errors?state.errors.map(error=>buildMessage(error,maxDepth)).join("\n"):buildMessage({error:Editor.Error.ERROR},maxDepth)}setLocalizations(texts){if(this.__localizations)for(const[name,subEditorLocalizations]of Object.entries(texts)){const existingLocalization=this.__localizations[name];if(existingLocalization)for(const[textName,text]of Object.entries(subEditorLocalizations))existingLocalization[textName]=text;else this.__localizations[name]=subEditorLocalizations}else this.__localizations=texts}__watchLocalization(name,localization,onChange){const existing=this.__localizationSymbols.get(name);existing?.destroyWatch(),existing?.symbol.destroy();const symbol=new TcHmi.Symbol(localization.symbolExpression),destroyWatch=symbol.watch(data=>{if(data.error!==TcHmi.Errors.NONE)return void(this.__parentControl?TcHmi.Log.Controls.error(this.__parentControl,Editor.#tchmiFQN,{SymbolExpression:localization.symbolExpression},TcHmi.Log.buildMessage(data.details)):TcHmi.Log.errorEx(`[Source=Control, Module=Beckhoff.TwinCAT.HMI.Controls, Origin=${Editor.#tchmiFQN}, SymbolExpression=${localization.symbolExpression}] `+TcHmi.Log.buildMessage(data.details)));let text=data.value??"";localization.formatValues.length>0&&(text=tchmi_format_string(text,...localization.formatValues)),onChange(text)});this.__localizationSymbols.set(name,{symbol,destroyWatch})}__unwatchLocalization(name){const existing=this.__localizationSymbols.get(name);existing&&(existing.destroyWatch(),existing.symbol.destroy(),this.__localizationSymbols.delete(name))}}Helpers.Editor=Editor,function(Editor){let Error;!function(Error){Error[Error.ERROR=1]="ERROR",Error[Error.RESTRICTION_ERROR=10]="RESTRICTION_ERROR",Error[Error.FAILS_ALL_RESTRICTIONS=11]="FAILS_ALL_RESTRICTIONS",Error[Error.FAILS_THIS_RESTRICTION=12]="FAILS_THIS_RESTRICTION",Error[Error.TYPE_ERROR=20]="TYPE_ERROR",Error[Error.NOT_A_BOOLEAN=21]="NOT_A_BOOLEAN",Error[Error.NOT_A_NUMBER=22]="NOT_A_NUMBER",Error[Error.NOT_A_STRING=23]="NOT_A_STRING",Error[Error.NOT_AN_OBJECT=24]="NOT_AN_OBJECT",Error[Error.NOT_AN_ARRAY=25]="NOT_AN_ARRAY",Error[Error.NOT_NULL=26]="NOT_NULL",Error[Error.BOOLEAN_ERROR=40]="BOOLEAN_ERROR",Error[Error.NUMBER_ERROR=60]="NUMBER_ERROR",Error[Error.NUMBER_TOO_SMALL=61]="NUMBER_TOO_SMALL",Error[Error.NUMBER_TOO_BIG=62]="NUMBER_TOO_BIG",Error[Error.NUMBER_NOT_MULTIPLE_OF=63]="NUMBER_NOT_MULTIPLE_OF",Error[Error.NUMBER_NOT_INTEGER=64]="NUMBER_NOT_INTEGER",Error[Error.NUMBER_NOT_FINITE=65]="NUMBER_NOT_FINITE",Error[Error.STRING_ERROR=80]="STRING_ERROR",Error[Error.STRING_TOO_SHORT=81]="STRING_TOO_SHORT",Error[Error.STRING_TOO_LONG=82]="STRING_TOO_LONG",Error[Error.STRING_DOES_NOT_MATCH=83]="STRING_DOES_NOT_MATCH",Error[Error.STRING_NOT_DATE_TIME=84]="STRING_NOT_DATE_TIME",Error[Error.STRING_NOT_TIMESPAN=85]="STRING_NOT_TIMESPAN",Error[Error.STRING_NOT_EMAIL=86]="STRING_NOT_EMAIL",Error[Error.STRING_NOT_HOSTNAME=87]="STRING_NOT_HOSTNAME",Error[Error.STRING_NOT_IPV4=88]="STRING_NOT_IPV4",Error[Error.STRING_NOT_IPV6=89]="STRING_NOT_IPV6",Error[Error.STRING_NOT_URI=90]="STRING_NOT_URI",Error[Error.OBJECT_ERROR=100]="OBJECT_ERROR",Error[Error.OBJECT_HAS_TOO_FEW_PROPERTIES=101]="OBJECT_HAS_TOO_FEW_PROPERTIES",Error[Error.OBJECT_HAS_TOO_MANY_PROPERTIES=102]="OBJECT_HAS_TOO_MANY_PROPERTIES",Error[Error.OBJECT_IS_MISSING_PROPERTY=103]="OBJECT_IS_MISSING_PROPERTY",Error[Error.OBJECT_CONTAINS_INVALID_PROPERTY_NAME=104]="OBJECT_CONTAINS_INVALID_PROPERTY_NAME",Error[Error.OBJECT_CONTAINS_INVALID_VALUE=105]="OBJECT_CONTAINS_INVALID_VALUE",Error[Error.OBJECT_HAS_INVALID_PROTOTYPE=106]="OBJECT_HAS_INVALID_PROTOTYPE",Error[Error.OBJECT_HAS_INVALID_DEPENDENCY=107]="OBJECT_HAS_INVALID_DEPENDENCY",Error[Error.ARRAY_ERROR=120]="ARRAY_ERROR",Error[Error.ARRAY_HAS_TOO_FEW_ITEMS=121]="ARRAY_HAS_TOO_FEW_ITEMS",Error[Error.ARRAY_HAS_TOO_MANY_ITEMS=122]="ARRAY_HAS_TOO_MANY_ITEMS",Error[Error.ARRAY_CONTAINS_INVALID_VALUE=123]="ARRAY_CONTAINS_INVALID_VALUE",Error[Error.ARRAY_CONTAINS_DUPLICATE_ITEMS=124]="ARRAY_CONTAINS_DUPLICATE_ITEMS",Error[Error.ARRAY_HAS_INVALID_PROTOTYPE=125]="ARRAY_HAS_INVALID_PROTOTYPE",Error[Error.TUPLE_ERROR=140]="TUPLE_ERROR",Error[Error.ENUM_ERROR=160]="ENUM_ERROR",Error[Error.ENUM_VALUE_NOT_A_MEMBER=161]="ENUM_VALUE_NOT_A_MEMBER",Error[Error.OPTIONAL_ERROR=180]="OPTIONAL_ERROR",Error[Error.OPTIONAL_TEMPORARILY_REQUIRED=181]="OPTIONAL_TEMPORARILY_REQUIRED",Error[Error.CHOICE_ERROR=200]="CHOICE_ERROR",Error[Error.DOES_NOT_FIT_ANY_CHOICE=201]="DOES_NOT_FIT_ANY_CHOICE",Error[Error.DOES_NOT_FIT_THIS_CHOICE=202]="DOES_NOT_FIT_THIS_CHOICE"}(Error=Editor.Error||(Editor.Error={}))}(Editor=Helpers.Editor||(Helpers.Editor={}))}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={}));var TcHmi,__runInitializers=this&&this.__runInitializers||function(thisArg,initializers,value){for(var useValue=arguments.length>2,i=0;i<initializers.length;i++)value=useValue?initializers[i].call(thisArg,value):initializers[i].call(thisArg);return useValue?value:void 0},__esDecorate=this&&this.__esDecorate||function(ctor,descriptorIn,decorators,contextIn,initializers,extraInitializers){function accept(f){if(void 0!==f&&"function"!=typeof f)throw new TypeError("Function expected");return f}for(var _,kind=contextIn.kind,key="getter"===kind?"get":"setter"===kind?"set":"value",target=!descriptorIn&&ctor?contextIn.static?ctor:ctor.prototype:null,descriptor=descriptorIn||(target?Object.getOwnPropertyDescriptor(target,contextIn.name):{}),done=!1,i=decorators.length-1;i>=0;i--){var context={};for(var p in contextIn)context[p]="access"===p?{}:contextIn[p];for(var p in contextIn.access)context.access[p]=contextIn.access[p];context.addInitializer=function(f){if(done)throw new TypeError("Cannot add initializers after decoration has completed");extraInitializers.push(accept(f||null))};var result=(0,decorators[i])("accessor"===kind?{get:descriptor.get,set:descriptor.set}:descriptor[key],context);if("accessor"===kind){if(void 0===result)continue;if(null===result||"object"!=typeof result)throw new TypeError("Object expected");(_=accept(result.get))&&(descriptor.get=_),(_=accept(result.set))&&(descriptor.set=_),(_=accept(result.init))&&initializers.unshift(_)}else(_=accept(result))&&("field"===kind?initializers.unshift(_):descriptor[key]=_)}target&&Object.defineProperty(target,contextIn.name,descriptor),done=!0};!function(TcHmi){!function(Controls){!function(Helpers){let TextboxBasedEditor=(()=>{let ___onTextChanged_decorators,___onKeydown_decorators,___onLocaleChanged_decorators,_classSuper=Helpers.Editor,_instanceExtraInitializers=[];return class extends _classSuper{static{const _metadata="function"==typeof Symbol&&Symbol.metadata?Object.create(_classSuper[Symbol.metadata]??null):void 0;___onTextChanged_decorators=[TcHmi.CallbackMethod],___onKeydown_decorators=[TcHmi.CallbackMethod],___onLocaleChanged_decorators=[TcHmi.CallbackMethod],__esDecorate(this,null,___onTextChanged_decorators,{kind:"method",name:"__onTextChanged",static:!1,private:!1,access:{has:obj=>"__onTextChanged"in obj,get:obj=>obj.__onTextChanged},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onKeydown_decorators,{kind:"method",name:"__onKeydown",static:!1,private:!1,access:{has:obj=>"__onKeydown"in obj,get:obj=>obj.__onKeydown},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onLocaleChanged_decorators,{kind:"method",name:"__onLocaleChanged",static:!1,private:!1,access:{has:obj=>"__onLocaleChanged"in obj,get:obj=>obj.__onLocaleChanged},metadata:_metadata},null,_instanceExtraInitializers),_metadata&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_metadata})}__textbox=__runInitializers(this,_instanceExtraInitializers);constructor(element,editorInfo,factory){super(element,editorInfo,factory);const textbox=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiInput",`${this.__name}.textbox`,{"data-tchmi-content-padding":{top:3,right:3,bottom:3,left:3}},this.__parentControl);if(!textbox)throw new Error("Could not create controls for textbox based editor.");this.__textbox=textbox,this.__childControls.add(textbox);const textboxElement=textbox.getElement()[0];textboxElement.classList.add("with-validation"),this.__element.appendChild(textboxElement),this.__eventDestroyers.push(TcHmi.EventProvider.register(textbox.getId()+".onTextChanged",this.__onTextChanged),TcHmi.EventProvider.registerDomEvent(textbox.getElement(),"keydown",this.__onKeydown),TcHmi.EventProvider.register("onLocaleChanged",this.__onLocaleChanged)),this.__updateValidationStatus()}startEditing(){this.__textbox.focus()}setAutoSelectText(valueNew){this.setSettings({textboxBasedEditor:{...this.__settings.textboxBasedEditor,autoSelectText:valueNew}})}getAutoSelectText(){return this.__settings.textboxBasedEditor?.autoSelectText}__onTextChanged(){if(this.__parentControl){if(!this.__parentControl.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this.__parentControl,"operate"))return}const state=this.getState();this.__updateValidationStatus(state),this.__onChangeManager.trigger(this,state)}__onKeydown(event){if(this.__parentControl){if(!this.__parentControl.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this.__parentControl,"operate"))return}if("Enter"===event.key){const state=this.getState();state.isValid&&this.__onConfirmManager.trigger(this,state)}}__onLocaleChanged(){this.__updateValidationStatus()}__updateValidationStatus(state=this.getState()){return this.__textbox.getElement()[0].classList.toggle("invalid",!state.isValid),TCHMI_DESIGNER||this.__textbox.setCustomValidity(this.__buildValidationMessage(state)),state.isValid}__processIsReadOnly(){this.__textbox.setIsReadOnly(this.__isReadOnly)}setSettings(settings){super.setSettings(settings),this.__textbox.setAutoSelectText(this.__settings.textboxBasedEditor?.autoSelectText??null),this.__textbox.setAutoFocusOut(this.__settings.textboxBasedEditor?.autoFocusOut??null)}}})();Helpers.TextboxBasedEditor=TextboxBasedEditor}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){class NumberEditor extends Helpers.TextboxBasedEditor{constructor(element,editorInfo,factory){super(element,editorInfo,factory),this.__textbox.setTextHorizontalAlignment("Right"),this.__textbox.setSystemKeyboardInputMode(editorInfo.restrictions.every(restriction=>restriction.isInteger)?"numeric":"decimal")}static validate(editorInfo,value){return 0===NumberEditor.checkForErrors(editorInfo,value,!0).length}static checkForErrors(editorInfo,value,returnEarly=!1){if("string"==typeof value)return value&&editorInfo.specialValues.has(value)&&editorInfo.restrictions.some(restriction=>!restriction.isInteger)?[]:[{error:Helpers.Editor.Error.NOT_A_NUMBER,parameters:[value]}];if("number"!=typeof value)return[{error:Helpers.Editor.Error.NOT_A_NUMBER,parameters:[value]}];if(!Number.isFinite(value)){const text=value.toString();return editorInfo.specialValues.has(text)&&editorInfo.restrictions.some(restriction=>!restriction.isInteger)?[]:[{error:Helpers.Editor.Error.NUMBER_NOT_FINITE,parameters:[value]}]}if(0===editorInfo.restrictions.length)return[];const restrictionErrors=[];for(const restriction of editorInfo.restrictions){const errors=[];if(restrictionErrors.push(errors),(!restriction.isInteger||Number.isInteger(value)||(errors.push({error:Helpers.Editor.Error.NUMBER_NOT_INTEGER,parameters:[value]}),!returnEarly))&&(!restriction.minimum||this.__testMinimum(value,restriction.minimum)||(errors.push({error:Helpers.Editor.Error.NUMBER_TOO_SMALL,parameters:[value,restriction.minimum.value,restriction.minimum.exclusive?">":">="]}),!returnEarly))&&(!restriction.maximum||this.__testMaximum(value,restriction.maximum)||(errors.push({error:Helpers.Editor.Error.NUMBER_TOO_BIG,parameters:[value,restriction.maximum.value,restriction.maximum.exclusive?"<":"<="]}),!returnEarly))&&(void 0===restriction.multipleOf||value%restriction.multipleOf===0||(errors.push({error:Helpers.Editor.Error.NUMBER_NOT_MULTIPLE_OF,parameters:[value,restriction.multipleOf]}),!returnEarly))&&0===errors.length)return[]}return 1===restrictionErrors.length?restrictionErrors[0]:[{error:Helpers.Editor.Error.FAILS_ALL_RESTRICTIONS,parameters:[value],underlying:restrictionErrors.map(errors=>({error:Helpers.Editor.Error.FAILS_THIS_RESTRICTION,underlying:errors}))}]}getState(){const value=this.getRawValue(),errors=NumberEditor.checkForErrors(this.__editorInfo,value);return 0===errors.length?{isValid:!0,value}:{isValid:!1,errors}}__processEditorInfo(){this.__updateValidationStatus()}static __testMinimum(value,minimum){return minimum.exclusive?value>minimum.value:value>=minimum.value}static __testMaximum(value,maximum){return maximum.exclusive?value<maximum.value:value<=maximum.value}setValue(value){"number"==typeof value?this.__textbox.setText(value.toString(10)):this.__textbox.setText(value)}getRawValue(){const text=this.__textbox.getText()??"";return/^[+-]?\d*\.?\d+(?:[eE][+-]?\d+)?$/.test(text)?parseFloat(text):text}}Helpers.NumberEditor=NumberEditor}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){class StringEditor extends Helpers.TextboxBasedEditor{constructor(element,editorInfo,factory){super(element,editorInfo,factory),this.__processEditorInfo()}static validate(editorInfo,value){return 0===StringEditor.checkForErrors(editorInfo,value,!0).length}static checkForErrors(editorInfo,value,returnEarly=!1){if("string"!=typeof value)return[{error:Helpers.Editor.Error.NOT_A_STRING,parameters:[value]}];if(0===editorInfo.restrictions.length)return[];const restrictionErrors=[];for(const restriction of editorInfo.restrictions){const errors=[];if(restrictionErrors.push(errors),!(void 0!==restriction.minLength&&value.length<restriction.minLength&&(errors.push({error:Helpers.Editor.Error.STRING_TOO_SHORT,parameters:[value,restriction.minLength,value.length]}),returnEarly))&&!(void 0!==restriction.maxLength&&value.length>restriction.maxLength&&(errors.push({error:Helpers.Editor.Error.STRING_TOO_LONG,parameters:[value,restriction.maxLength,value.length]}),returnEarly))&&(!restriction.patterns||restriction.patterns.every(pattern=>pattern.test(value))||(errors.push({error:Helpers.Editor.Error.STRING_DOES_NOT_MATCH,parameters:[value,restriction.patterns]}),!returnEarly))){if(restriction.format){let regex,error;switch(restriction.format){case"date-time":regex=/^\d{4}-(?:0\d|1[0-2])-(?:[0-2]\d|3[01])[Tt\s](?:[01]\d|2[0-3]):[0-5]\d:(?:[0-5]\d|60)(?:.\d+)?(?:[Zz]|[+-](?:[01]\d|2[0-3]):[0-5]\d)$/,error=Helpers.Editor.Error.STRING_NOT_DATE_TIME;break;case"timespan":regex=/^P(?=.{2,})(?:\d+Y|\d+[.,]\d+Y$)?(?:\d+M|\d+[.,]\d+M$)?(?:\d+W|\d+[.,]\d+W$)?(?:\d+D|\d+[.,]\d+D$)?(?:T(?:\d+H|\d+[.,]\d+H$)?(?:\d+M|\d+[.,]\d+M$)?(?:\d+S|\d+[.,]\d+S$)?)?$/,error=Helpers.Editor.Error.STRING_NOT_TIMESPAN;break;case"email":regex=/^(?:[^@\s"]+|".+")@(?:[^@.\s]+\.)+[^@.\s]+$/,error=Helpers.Editor.Error.STRING_NOT_EMAIL;break;case"hostname":regex=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,error=Helpers.Editor.Error.STRING_NOT_HOSTNAME;break;case"ipv4":regex=/^(?:(?:25[0-5]|2[0-4]\d|[0-1]?\d?\d)\.){3}(?:25[0-5]|2[0-4]\d|[0-1]?\d?\d)$/,error=Helpers.Editor.Error.STRING_NOT_IPV4;break;case"ipv6":regex=/^(?:[0-9A-F]{1,4}:){7}[0-9A-F]{1,4}$|^(?:[0-9A-F]{1,4}:){6}(?:(?:25[0-5]|2[0-4]\d|[0-1]?\d?\d)\.){3}(?:25[0-5]|2[0-4]\d|[0-1]?\d?\d)$|^(?=.*::)(?!.*(::).*\1.*)(?!.*:::.*)(?:(?:::)?(?:[0-9A-F]{1,4}::?){0,6}(?:[0-9A-F]{1,4}|::?)|(?:::)?(?:[0-9A-F]{1,4}::?){0,5}(?:(?:25[0-5]|2[0-4]\d|[0-1]?\d?\d)\.){3}(?:25[0-5]|2[0-4]\d|[0-1]?\d?\d))$/i,error=Helpers.Editor.Error.STRING_NOT_IPV6;break;case"uri":regex=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,error=Helpers.Editor.Error.STRING_NOT_URI;break;default:regex=/[\s\S]*/,error=Helpers.Editor.Error.ERROR}if(!regex.test(value)&&(errors.push({error,parameters:[value]}),returnEarly))continue}if(0===errors.length)return[]}}return 1===restrictionErrors.length?restrictionErrors[0]:[{error:Helpers.Editor.Error.FAILS_ALL_RESTRICTIONS,parameters:[value],underlying:restrictionErrors.map(errors=>({error:Helpers.Editor.Error.FAILS_THIS_RESTRICTION,underlying:errors}))}]}__processEditorInfo(){this.__updateValidationStatus()}setValue(value){this.__textbox.setText(value)}getRawValue(){return this.__textbox.getText()??""}}Helpers.StringEditor=StringEditor}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){let TimeEditor=(()=>{let ___onDateTimeChanged_decorators,___onDateTimeButtonPressed_decorators,___onTimespanChanged_decorators,___onTimespanButtonPressed_decorators,_classSuper=Helpers.TextboxBasedEditor,_instanceExtraInitializers=[];return class TimeEditor extends _classSuper{static{const _metadata="function"==typeof Symbol&&Symbol.metadata?Object.create(_classSuper[Symbol.metadata]??null):void 0;___onDateTimeChanged_decorators=[TcHmi.CallbackMethod],___onDateTimeButtonPressed_decorators=[TcHmi.CallbackMethod],___onTimespanChanged_decorators=[TcHmi.CallbackMethod],___onTimespanButtonPressed_decorators=[TcHmi.CallbackMethod],__esDecorate(this,null,___onDateTimeChanged_decorators,{kind:"method",name:"__onDateTimeChanged",static:!1,private:!1,access:{has:obj=>"__onDateTimeChanged"in obj,get:obj=>obj.__onDateTimeChanged},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onDateTimeButtonPressed_decorators,{kind:"method",name:"__onDateTimeButtonPressed",static:!1,private:!1,access:{has:obj=>"__onDateTimeButtonPressed"in obj,get:obj=>obj.__onDateTimeButtonPressed},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onTimespanChanged_decorators,{kind:"method",name:"__onTimespanChanged",static:!1,private:!1,access:{has:obj=>"__onTimespanChanged"in obj,get:obj=>obj.__onTimespanChanged},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onTimespanButtonPressed_decorators,{kind:"method",name:"__onTimespanButtonPressed",static:!1,private:!1,access:{has:obj=>"__onTimespanButtonPressed"in obj,get:obj=>obj.__onTimespanButtonPressed},metadata:_metadata},null,_instanceExtraInitializers),_metadata&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_metadata})}__container=__runInitializers(this,_instanceExtraInitializers);__dateTimePicker;__dateTimeButton;__timespanPicker;__timespanButton;constructor(element,editorInfo,factory){super(element,editorInfo,factory),this.__container=document.createElement("div"),this.__container.classList.add("compound-control-container","with-validation");for(const child of this.__element.children)this.__container.appendChild(child);if(this.__processEditorInfo(),!(this.__dateTimeButton||this.__dateTimePicker||this.__timespanButton||this.__timespanPicker))throw new Error("Could not create controls for time editor.");element.appendChild(this.__container)}destroy(){this.__dateTimeButton&&TcHmi.Binding.removeEx2(null,"Tooltip",this.__dateTimeButton),this.__timespanButton&&TcHmi.Binding.removeEx2(null,"Tooltip",this.__timespanButton),super.destroy()}static validate(editorInfo,value){return 0===TimeEditor.checkForErrors(editorInfo,value,!0).length}static checkForErrors(editorInfo,value,returnEarly=!1){return Helpers.StringEditor.checkForErrors({type:"string",schema:editorInfo.schema,name:"String",restrictions:Array.from(editorInfo.formats).map(format=>({format}))},value,returnEarly)}getState(){const value=this.getRawValue(),errors=TimeEditor.checkForErrors(this.__editorInfo,value);return 0===errors.length?{isValid:!0,value}:{isValid:!1,errors}}__processEditorInfo(){this.__editorInfo.formats.has("date-time")?(this.__dateTimeButton&&this.__dateTimePicker||this.__createDateTimeControls(),this.__dateTimeButton?.setVisibility("Visible")):this.__dateTimeButton?.setVisibility("Collapsed"),this.__editorInfo.formats.has("timespan")?(this.__timespanButton&&this.__timespanPicker||this.__createTimespanControls(),this.__timespanButton?.setVisibility("Visible")):this.__timespanButton?.setVisibility("Collapsed"),this.__updateValidationStatus()}__updateValidationStatus(state=this.getState()){const isValid=super.__updateValidationStatus(state);return this.__container?.classList.toggle("invalid",!isValid),isValid}__processIsReadOnly(){this.__dateTimePicker?.setIsReadOnly(this.__isReadOnly),this.__timespanPicker?.setIsReadOnly(this.__isReadOnly)}setValue(value){this.__textbox.setText(value)}getRawValue(){return this.__textbox.getText()??""}__createDateTimeControls(){const dateTimePicker=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiDateTimePicker",`${this.__name}.dateTimePicker`,{"data-tchmi-visibility":"Collapsed","data-tchmi-is-enabled":this.__isEnabled,"data-tchmi-is-read-only":this.__isReadOnly},this.__parentControl),dateTimeButton=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__name}.dateTimeButton`,{"data-tchmi-width":26,"data-tchmi-height":100,"data-tchmi-height-unit":"%","data-tchmi-is-enabled":this.__isEnabled},this.__parentControl);if(!dateTimePicker||!dateTimeButton)return;this.__dateTimePicker=dateTimePicker,this.__dateTimeButton=dateTimeButton,this.__childControls.add(dateTimePicker),this.__childControls.add(dateTimeButton),this.__localizeDateTimeButton(),this.__eventDestroyers.push(TcHmi.EventProvider.register(dateTimePicker.getId()+".onValueChanged",this.__onDateTimeChanged),TcHmi.EventProvider.register(dateTimeButton.getId()+".onPressed",this.__onDateTimeButtonPressed));const dateTimeButtonElement=dateTimeButton.getElement()[0];dateTimeButtonElement.classList.add(`${this.__className}-button-icon-datetimepicker`),this.__container.appendChild(dateTimePicker.getElement()[0]),this.__container.appendChild(dateTimeButtonElement)}__createTimespanControls(){const timespanPicker=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiTimespanPicker",`${this.__name}.timespanPicker`,{"data-tchmi-visibility":"Collapsed","data-tchmi-is-enabled":this.__isEnabled,"data-tchmi-is-read-only":this.__isReadOnly},this.__parentControl),timespanButton=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__name}.timespanButton`,{"data-tchmi-width":26,"data-tchmi-height":100,"data-tchmi-height-unit":"%","data-tchmi-is-enabled":this.__isEnabled},this.__parentControl);if(!timespanPicker||!timespanButton)throw new Error("Could not create controls for time editor.");this.__timespanPicker=timespanPicker,this.__timespanButton=timespanButton,this.__childControls.add(timespanPicker),this.__childControls.add(timespanButton),this.__localizeTimespanButton(),this.__eventDestroyers.push(TcHmi.EventProvider.register(timespanPicker.getId()+".onValueChanged",this.__onTimespanChanged),TcHmi.EventProvider.register(timespanButton.getId()+".onPressed",this.__onTimespanButtonPressed));const timespanButtonElement=timespanButton.getElement()[0];timespanButtonElement.classList.add(`${this.__className}-button-icon-timespanpicker`),this.__container.appendChild(timespanPicker.getElement()[0]),this.__container.appendChild(timespanButtonElement)}__onDateTimeChanged(){const value=this.__dateTimePicker?.getValue();value&&this.__textbox.setText(value)}__onDateTimeButtonPressed(){if(!this.__dateTimePicker)return;const text=this.__textbox.getText();this.__dateTimePicker.setValue(text||null),this.__dateTimePicker.openDateTimePicker()}__onTimespanChanged(){const value=this.__timespanPicker?.getValue();value&&this.__textbox.setText(value)}__onTimespanButtonPressed(){if(!this.__timespanPicker)return;const text=this.__textbox.getText();this.__timespanPicker.setValue(text||null),this.__timespanPicker.openTimespanPicker()}setLocalizations(texts){super.setLocalizations(texts),this.__localizeDateTimeButton(),this.__localizeTimespanButton()}__localizeDateTimeButton(){this.__dateTimeButton&&this.__localizations?.timeEditor?.dateTimeButtonTooltip&&("string"==typeof this.__localizations.timeEditor.dateTimeButtonTooltip?(this.__unwatchLocalization("dateTimeButtonTooltip"),TcHmi.Binding.createEx2(this.__localizations.timeEditor.dateTimeButtonTooltip,"Tooltip",this.__dateTimeButton)):(TcHmi.Binding.removeEx2(null,"Tooltip",this.__dateTimeButton),this.__watchLocalization("dateTimeButtonTooltip",this.__localizations.timeEditor.dateTimeButtonTooltip,text=>this.__dateTimeButton?.setTooltip(text))))}__localizeTimespanButton(){this.__timespanButton&&this.__localizations?.timeEditor?.timespanButtonTooltip&&("string"==typeof this.__localizations.timeEditor.timespanButtonTooltip?(this.__unwatchLocalization("timespanButtonTooltip"),TcHmi.Binding.createEx2(this.__localizations.timeEditor.timespanButtonTooltip,"Tooltip",this.__timespanButton)):(TcHmi.Binding.removeEx2(null,"Tooltip",this.__timespanButton),this.__watchLocalization("timespanButtonTooltip",this.__localizations.timeEditor.timespanButtonTooltip,text=>this.__timespanButton?.setTooltip(text))))}}})();Helpers.TimeEditor=TimeEditor}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){let ComboboxBasedEditor=(()=>{let ___onSelectionChanged_decorators,_classSuper=Helpers.Editor,_instanceExtraInitializers=[];return class extends _classSuper{static{const _metadata="function"==typeof Symbol&&Symbol.metadata?Object.create(_classSuper[Symbol.metadata]??null):void 0;___onSelectionChanged_decorators=[TcHmi.CallbackMethod],__esDecorate(this,null,___onSelectionChanged_decorators,{kind:"method",name:"__onSelectionChanged",static:!1,private:!1,access:{has:obj=>"__onSelectionChanged"in obj,get:obj=>obj.__onSelectionChanged},metadata:_metadata},null,_instanceExtraInitializers),_metadata&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_metadata})}__combobox=__runInitializers(this,_instanceExtraInitializers);constructor(element,editorInfo,factory){super(element,editorInfo,factory);const combobox=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiCombobox",`${this.__name}.combobox`,{"data-tchmi-content-padding":{top:3,right:3,bottom:3,left:3}},this.__parentControl);if(!combobox)throw new Error("Could not create controls for combobox based editor.");this.__combobox=combobox,this.__childControls.add(combobox);const comboboxElement=combobox.getElement()[0];comboboxElement.classList.add("with-validation","invalid"),this.__element.appendChild(comboboxElement),this.__eventDestroyers.push(TcHmi.EventProvider.register(combobox.getId()+".onSelectionChanged",this.__onSelectionChanged))}startEditing(){this.__combobox.focus(),this.__combobox.open()}__onSelectionChanged(){if(this.__parentControl){if(!this.__parentControl.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this.__parentControl,"operate"))return}const state=this.getState();this.__combobox.getElement()[0].classList.toggle("invalid",!state.isValid),this.__onChangeManager.trigger(this,state),state.isValid&&this.__onConfirmManager.trigger(this,state)}__processIsReadOnly(){this.__combobox.setIsReadOnly(this.__isReadOnly)}}})();Helpers.ComboboxBasedEditor=ComboboxBasedEditor}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){class EnumEditor extends Helpers.ComboboxBasedEditor{constructor(element,editorInfo,factory){super(element,editorInfo,factory),this.__processEditorInfo()}static validate(editorInfo,value){return editorInfo.members.has(value)}static checkForErrors(editorInfo,value,_returnEarly=!1){return editorInfo.members.has(value)?[]:[{error:Helpers.Editor.Error.ENUM_VALUE_NOT_A_MEMBER}]}__processEditorInfo(){function stringify(value){return"string"==typeof value?value:JSON.stringify(value)}this.__combobox.setSrcData(Array.from(this.__editorInfo.members.entries()).map(([value,label])=>({value,text:label?`${label} (${stringify(value)})`:stringify(value)})))}setValue(value){if(null==value)this.__combobox.setSelectedIndex(null);else{const index=Array.from(this.__editorInfo.members.keys()).indexOf(value);this.__combobox.setSelectedIndex(-1!==index?index:null)}}getRawValue(){return this.__combobox.getSelectedValue()}}Helpers.EnumEditor=EnumEditor}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){class BooleanEditor extends Helpers.ComboboxBasedEditor{__comboboxTexts={false:"",true:""};constructor(element,editorInfo,factory){super(element,editorInfo,factory),this.__updateSrcData()}static validate(_editorInfo,value){return"boolean"==typeof value}static checkForErrors(_editorInfo,value,_returnEarly=!1){return"boolean"!=typeof value?[{error:Helpers.Editor.Error.NOT_A_BOOLEAN}]:[]}__processEditorInfo(){}setValue(value){switch(value){case!1:this.__combobox.setSelectedIndex(0);break;case!0:this.__combobox.setSelectedIndex(1);break;default:this.__combobox.setSelectedIndex(null)}}getRawValue(){return this.__combobox.getSelectedValue()}__updateSrcData(){this.__combobox.setSrcData([{value:!1,text:this.__comboboxTexts.false},{value:!0,text:this.__comboboxTexts.true}])}setLocalizations(texts){super.setLocalizations(texts);let update=!1;this.__localizations&&(this.__localizations.booleanEditor?.falseText&&("string"==typeof this.__localizations.booleanEditor.falseText?(this.__comboboxTexts.false=this.__localizations.booleanEditor.falseText,update=!0):this.__watchLocalization("falseText",this.__localizations.booleanEditor.falseText,text=>{this.__comboboxTexts.false=text,this.__updateSrcData()})),this.__localizations.booleanEditor?.trueText&&("string"==typeof this.__localizations.booleanEditor.trueText?(this.__comboboxTexts.true=this.__localizations.booleanEditor.trueText,update=!0):this.__watchLocalization("trueText",this.__localizations.booleanEditor.trueText,text=>{this.__comboboxTexts.true=text,this.__updateSrcData()}))),update&&this.__updateSrcData()}}Helpers.BooleanEditor=BooleanEditor}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){let ButtonBasedEditor=(()=>{let ___onPressed_decorators,_classSuper=Helpers.Editor,_instanceExtraInitializers=[];return class extends _classSuper{static{const _metadata="function"==typeof Symbol&&Symbol.metadata?Object.create(_classSuper[Symbol.metadata]??null):void 0;___onPressed_decorators=[TcHmi.CallbackMethod],__esDecorate(this,null,___onPressed_decorators,{kind:"method",name:"__onPressed",static:!1,private:!1,access:{has:obj=>"__onPressed"in obj,get:obj=>obj.__onPressed},metadata:_metadata},null,_instanceExtraInitializers),_metadata&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_metadata})}__container=__runInitializers(this,_instanceExtraInitializers);__textSpan;__button;__popup;constructor(element,editorInfo,factory){super(element,editorInfo,factory),this.__container=document.createElement("div"),this.__container.classList.add("compound-control-container","with-validation"),this.__textSpan=document.createElement("span"),this.__textSpan.classList.add("value-description"),this.__container.appendChild(this.__textSpan);const button=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__name}.button`,{"data-tchmi-width":26,"data-tchmi-height":100,"data-tchmi-height-unit":"%","data-tchmi-text":"..."},this.__parentControl);if(!button)throw new Error("Could not create controls for button based editor.");this.__button=button,this.__childControls.add(button),this.__container.appendChild(button.getElement()[0]),this.__element.appendChild(this.__container),this.__eventDestroyers.push(TcHmi.EventProvider.register(button.getId()+".onPressed",this.__onPressed))}destroy(){TcHmi.Binding.removeEx2(null,"Tooltip",this.__button),super.destroy()}__onPressed(){if(this.__parentControl){if(!this.__parentControl.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this.__parentControl,"operate"))return}this.openPopup()}startEditing(){this.openPopup()}__processIsReadOnly(){this.__popup?.setIsReadOnly(this.__isReadOnly)}setSettings(settings){super.setSettings(settings),this.__popup?.setSettings(this.__settings)}setLocalizations(texts){super.setLocalizations(texts),this.__localizations&&this.__localizations.buttonBasedEditor?.buttonTooltip&&("string"==typeof this.__localizations.buttonBasedEditor.buttonTooltip?(this.__unwatchLocalization("buttonTooltip"),TcHmi.Binding.createEx2(this.__localizations.buttonBasedEditor.buttonTooltip,"Tooltip",this.__button)):(TcHmi.Binding.removeEx2(null,"Tooltip",this.__button),this.__watchLocalization("buttonTooltip",this.__localizations.buttonBasedEditor.buttonTooltip,text=>this.__button.setTooltip(text)))),this.__popup?.setLocalizations({buttonTextOk:this.__localizations?.editorPrompt?.buttonTextOk,buttonTooltipOk:this.__localizations?.editorPrompt?.buttonTooltipOk,buttonTextCancel:this.__localizations?.editorPrompt?.buttonTextCancel,buttonTooltipCancel:this.__localizations?.editorPrompt?.buttonTooltipCancel,editorLocalizations:this.__localizations})}}})();Helpers.ButtonBasedEditor=ButtonBasedEditor}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){class ObjectEditor extends Helpers.ButtonBasedEditor{__value={};constructor(element,editorInfo,factory){super(element,editorInfo,factory),this.__processEditorInfo()}destroy(){super.destroy(),this.__popup?.destroy(!0)}static validate(editorInfo,value){return 0===ObjectEditor.checkForErrors(editorInfo,value,!0).length}static checkForErrors(editorInfo,value,returnEarly=!1){if("object"!=typeof value||null===value||Array.isArray(value))return[{error:Helpers.Editor.Error.NOT_AN_OBJECT,parameters:[value]}];if(null!==Object.getPrototypeOf(value)&&Object.getPrototypeOf(value)!==Object.getPrototypeOf({}))return[{error:Helpers.Editor.Error.OBJECT_HAS_INVALID_PROTOTYPE,parameters:[value]}];const resolvedInfo=ObjectEditor.resolveDependencies(editorInfo,new Set(Object.keys(value)));if("invalid"===resolvedInfo.type)return[{error:Helpers.Editor.Error.OBJECT_HAS_INVALID_DEPENDENCY,parameters:[value]}];editorInfo=resolvedInfo;const errors=[];for(const[name,info]of editorInfo.properties)if(("optional"!==info.type||info.temporarilyRequired)&&void 0===value[name]&&(errors.push({error:Helpers.Editor.Error.OBJECT_IS_MISSING_PROPERTY,parameters:[value,name]}),returnEarly))return errors;const isValidName=name=>!!editorInfo.additionalProperties.allowed||(!!editorInfo.properties.has(name)||!(!editorInfo.patternProperties||!Array.from(editorInfo.patternProperties.keys()).some(regex=>regex.test(name))));let propertiesCount=0;for(const propertyName in value){if(!isValidName(propertyName)&&(errors.push({error:Helpers.Editor.Error.OBJECT_CONTAINS_INVALID_PROPERTY_NAME,parameters:[value,propertyName]}),returnEarly))return errors;const propertyEditorInfo=ObjectEditor.getEditorInfoForProperty(editorInfo,propertyName),underlyingErrors=Helpers.Editor.checkForErrors(propertyEditorInfo,value[propertyName],returnEarly);if(underlyingErrors.length>0&&(errors.push({error:Helpers.Editor.Error.OBJECT_CONTAINS_INVALID_VALUE,parameters:[value,propertyName],underlying:underlyingErrors}),returnEarly))return errors;void 0!==value[propertyName]&&propertiesCount++}return void 0!==editorInfo.minProperties&&propertiesCount<editorInfo.minProperties&&(errors.push({error:Helpers.Editor.Error.OBJECT_HAS_TOO_FEW_PROPERTIES,parameters:[value,editorInfo.minProperties,propertiesCount]}),returnEarly)||void 0!==editorInfo.maxProperties&&propertiesCount>editorInfo.maxProperties&&errors.push({error:Helpers.Editor.Error.OBJECT_HAS_TOO_MANY_PROPERTIES,parameters:[value,editorInfo.maxProperties,propertiesCount]}),errors}__processEditorInfo(){this.__popup?.setEditorInfo(this.__editorInfo),this.__textSpan.textContent=this.__editorInfo.name,this.__container.classList.toggle("invalid",!this.getState().isValid)}static resolveDependencies(editorInfo,knownProperties){if(!editorInfo.dependencies)return editorInfo;const matchingDependencies=[];for(const[name,dependency]of editorInfo.dependencies)knownProperties.has(name)&&matchingDependencies.push(dependency);if(0===matchingDependencies.length)return editorInfo;const result=Helpers.SchemaParser.mergeEditorInfos(editorInfo,...matchingDependencies.map(dependency=>this.resolveDependencies(dependency,knownProperties)));return"object"!==result.type?{type:"invalid",schema:result.schema,name:"Invalid"}:result}static getEditorInfoForProperty(editorInfo,property){let info=editorInfo.properties.get(property);if(!info&&editorInfo.patternProperties){const matchingInfos=[];for(const[pattern,info]of editorInfo.patternProperties)pattern.test(property)&&matchingInfos.push(info);matchingInfos.length>0&&(info=Helpers.SchemaParser.mergeEditorInfos(...matchingInfos))}return!info&&editorInfo.additionalProperties.allowed&&(info=editorInfo.additionalProperties.editorInfo??Helpers.ChoiceEditor.createAnyEditorInfo()),info||(info={type:"invalid",schema:{},name:"Invalid"}),info}setValue(value){this.__value=value??{},this.__popup?.setValue(value);const state=this.getState();this.__container.classList.toggle("invalid",!state.isValid),this.__onChangeManager.trigger(this,state)}getRawValue(){return this.__value}async openPopup(){this.__popup||(this.__popup=new Helpers.ObjectEditorPrompt(this.__editorInfo,this.__factory),this.__popup.setBackgroundAction({close:!0,action:"cancel"}),this.__popup.setIsReadOnly(this.__isReadOnly),this.__popup.setSettings(this.__settings),this.__popup.setLocalizations({buttonTextOk:this.__localizations?.objectEditorPrompt?.buttonTextOk??this.__localizations?.editorPrompt?.buttonTextOk,buttonTooltipOk:this.__localizations?.objectEditorPrompt?.buttonTooltipOk??this.__localizations?.editorPrompt?.buttonTooltipOk,buttonTextCancel:this.__localizations?.objectEditorPrompt?.buttonTextCancel??this.__localizations?.editorPrompt?.buttonTextCancel,buttonTooltipCancel:this.__localizations?.objectEditorPrompt?.buttonTooltipCancel??this.__localizations?.editorPrompt?.buttonTooltipCancel,editorLocalizations:this.__localizations}));try{this.__popup.setValue(this.__value);const result=await this.__popup.prompt();if(result.isOk){this.__value=result.value;const state=this.getState();this.__container.classList.toggle("invalid",!state.isValid),this.__onChangeManager.trigger(this,state),state.isValid&&this.__onConfirmManager.trigger(this,state)}}catch(ex){}}setLocalizations(texts){super.setLocalizations(texts),this.__popup?.setLocalizations({buttonTextOk:this.__localizations?.objectEditorPrompt?.buttonTextOk??this.__localizations?.editorPrompt?.buttonTextOk,buttonTooltipOk:this.__localizations?.objectEditorPrompt?.buttonTooltipOk??this.__localizations?.editorPrompt?.buttonTooltipOk,buttonTextCancel:this.__localizations?.objectEditorPrompt?.buttonTextCancel??this.__localizations?.editorPrompt?.buttonTextCancel,buttonTooltipCancel:this.__localizations?.objectEditorPrompt?.buttonTooltipCancel??this.__localizations?.editorPrompt?.buttonTooltipCancel,editorLocalizations:this.__localizations})}}Helpers.ObjectEditor=ObjectEditor}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){let ObjectEditorPane=(()=>{let ___onEditorChanged_decorators,___onAddPropertyPressed_decorators,___onNewPropertyTextChanged_decorators,___onAcceptNewPropertyPressed_decorators,___onCancelNewPropertyPressed_decorators,___onLocaleChanged_decorators,_classSuper=Helpers.Editor,_instanceExtraInitializers=[];return class extends _classSuper{static{const _metadata="function"==typeof Symbol&&Symbol.metadata?Object.create(_classSuper[Symbol.metadata]??null):void 0;___onEditorChanged_decorators=[TcHmi.CallbackMethod],___onAddPropertyPressed_decorators=[TcHmi.CallbackMethod],___onNewPropertyTextChanged_decorators=[TcHmi.CallbackMethod],___onAcceptNewPropertyPressed_decorators=[TcHmi.CallbackMethod],___onCancelNewPropertyPressed_decorators=[TcHmi.CallbackMethod],___onLocaleChanged_decorators=[TcHmi.CallbackMethod],__esDecorate(this,null,___onEditorChanged_decorators,{kind:"method",name:"__onEditorChanged",static:!1,private:!1,access:{has:obj=>"__onEditorChanged"in obj,get:obj=>obj.__onEditorChanged},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onAddPropertyPressed_decorators,{kind:"method",name:"__onAddPropertyPressed",static:!1,private:!1,access:{has:obj=>"__onAddPropertyPressed"in obj,get:obj=>obj.__onAddPropertyPressed},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onNewPropertyTextChanged_decorators,{kind:"method",name:"__onNewPropertyTextChanged",static:!1,private:!1,access:{has:obj=>"__onNewPropertyTextChanged"in obj,get:obj=>obj.__onNewPropertyTextChanged},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onAcceptNewPropertyPressed_decorators,{kind:"method",name:"__onAcceptNewPropertyPressed",static:!1,private:!1,access:{has:obj=>"__onAcceptNewPropertyPressed"in obj,get:obj=>obj.__onAcceptNewPropertyPressed},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onCancelNewPropertyPressed_decorators,{kind:"method",name:"__onCancelNewPropertyPressed",static:!1,private:!1,access:{has:obj=>"__onCancelNewPropertyPressed"in obj,get:obj=>obj.__onCancelNewPropertyPressed},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onLocaleChanged_decorators,{kind:"method",name:"__onLocaleChanged",static:!1,private:!1,access:{has:obj=>"__onLocaleChanged"in obj,get:obj=>obj.__onLocaleChanged},metadata:_metadata},null,_instanceExtraInitializers),_metadata&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_metadata})}__editorTable=__runInitializers(this,_instanceExtraInitializers);__newPropertyContainer;__newPropertyTextbox;__acceptNewPropertyButton;__cancelNewPropertyButton;__addPropertyButton;__removeButtonTooltip="";__errorContainer;__editors=new Map;__dependencyOverride;__pauseChangeHandlers=!1;constructor(element,editorInfo,factory){super(element,editorInfo,factory),this.__dependencyOverride=editorInfo,this.__editorTable=document.createElement("table"),this.__editorTable.classList.add(`${this.__className}-editor-table`),this.__element.appendChild(this.__editorTable);const newPropertyTextbox=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiInput",`${this.__name}.NewPropertyTextbox`,{"data-tchmi-content-padding":{top:3,right:3,bottom:3,left:3}},this.__parentControl),acceptNewPropertyButton=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__name}.AcceptNewPropertyButton`,{"data-tchmi-width":30,"data-tchmi-height":30,"data-tchmi-is-enabled":!1},this.__parentControl),cancelNewPropertyButton=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__name}.CancelNewPropertyButton`,{"data-tchmi-width":30,"data-tchmi-height":30},this.__parentControl),addPropertyButton=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__name}.AddPropertyButton`,{"data-tchmi-width":30,"data-tchmi-height":30,"data-tchmi-visibility":"Collapsed"},this.__parentControl);if(!(newPropertyTextbox&&acceptNewPropertyButton&&cancelNewPropertyButton&&addPropertyButton))throw new Error("Could not create controls for object editor.");this.__newPropertyTextbox=newPropertyTextbox,this.__acceptNewPropertyButton=acceptNewPropertyButton,this.__cancelNewPropertyButton=cancelNewPropertyButton,this.__addPropertyButton=addPropertyButton,this.__childControls.add(newPropertyTextbox),this.__childControls.add(acceptNewPropertyButton),this.__childControls.add(cancelNewPropertyButton),this.__childControls.add(addPropertyButton),this.__newPropertyContainer=document.createElement("div"),this.__newPropertyContainer.classList.add("new-property-container");const newPropertyTextboxElement=newPropertyTextbox.getElement()[0];newPropertyTextboxElement.classList.add("with-validation");const cancelNewPropertyButtonElement=cancelNewPropertyButton.getElement()[0];cancelNewPropertyButtonElement.classList.add(`${this.__className}-button-icon-remove`),this.__newPropertyContainer.appendChild(newPropertyTextboxElement),this.__newPropertyContainer.appendChild(acceptNewPropertyButton.getElement()[0]),this.__newPropertyContainer.appendChild(cancelNewPropertyButtonElement),this.__element.appendChild(this.__newPropertyContainer);addPropertyButton.getElement()[0].classList.add(`${this.__className}-button-icon-add`),this.__element.appendChild(addPropertyButton.getElement()[0]),this.__errorContainer=document.createElement("div"),this.__errorContainer.classList.add("validation-errors"),this.__element.appendChild(this.__errorContainer),this.__eventDestroyers.push(TcHmi.EventProvider.register(newPropertyTextbox.getId()+".onTextChanged",this.__onNewPropertyTextChanged),TcHmi.EventProvider.register(acceptNewPropertyButton.getId()+".onPressed",this.__onAcceptNewPropertyPressed),TcHmi.EventProvider.register(cancelNewPropertyButton.getId()+".onPressed",this.__onCancelNewPropertyPressed),TcHmi.EventProvider.register(addPropertyButton.getId()+".onPressed",this.__onAddPropertyPressed),TcHmi.EventProvider.register("onLocaleChanged",this.__onLocaleChanged)),this.__processEditorInfo()}destroy(){TcHmi.Binding.removeEx2(null,"Tooltip",this.__addPropertyButton),TcHmi.Binding.removeEx2(null,"Text",this.__acceptNewPropertyButton),TcHmi.Binding.removeEx2(null,"Tooltip",this.__acceptNewPropertyButton),TcHmi.Binding.removeEx2(null,"Tooltip",this.__cancelNewPropertyButton);for(const editorEntry of this.__editors.values())editorEntry.editor.destroy(),editorEntry.removeButton&&TcHmi.Binding.removeEx2(null,"Tooltip",editorEntry.removeButton);this.__editors.clear(),super.destroy()}__processEditorInfo(){this.__pauseChangeHandlers=!0;const value=this.getRawValue();this.__editorTable.innerHTML="";for(const name of this.__editors.keys())this.__removeEditorRow(name);for(const[name,info]of this.__editorInfo.properties){const editorEntry=this.__createEditorRow(name,info,!1);this.__editorTable.appendChild(editorEntry.row),this.__editors.set(name,editorEntry)}this.__addPropertyButton.setVisibility(this.__editorInfo.additionalProperties.editorInfo||this.__editorInfo.patternProperties?"Visible":"Collapsed"),this.setValue(value),this.__pauseChangeHandlers=!1}setValue(value){this.__pauseChangeHandlers=!0;const missingProperties=new Set(this.__editors.keys());if(value)for(const key in value){let editorEntry=this.__editors.get(key);if(editorEntry)editorEntry.editor.setValue(value[key]),missingProperties.delete(key);else{const editorInfo=Helpers.ObjectEditor.getEditorInfoForProperty(this.__editorInfo,key);editorEntry=this.__createEditorRow(key,editorInfo,!0),this.__editorTable.appendChild(editorEntry.row),this.__editors.set(key,editorEntry),editorEntry.editor.setValue(value[key])}}for(const name of missingProperties){const editorEntry=this.__editors.get(name);editorEntry&&(editorEntry.additionalDestroyer?this.__removeEditorRow(name):editorEntry.editor.setValue(void 0))}this.__pauseChangeHandlers=!1;const state=this.getState();this.__onChangeManager.trigger(this,state),this.__applyDependencies(),this.__updateValidationStatus(state)}getRawValue(){const value={};for(const[name,entry]of this.__editors){const rawValue=entry.editor.getRawValue();void 0!==rawValue&&(value[name]=rawValue)}return value}__applyDependencies(){this.__pauseChangeHandlers=!0;const knownProperties=new Set;for(const[name,entry]of this.__editors)void 0!==entry.editor.getRawValue()&&knownProperties.add(name);let resolvedInfo,knownPropertiesCount;do{if(resolvedInfo=Helpers.ObjectEditor.resolveDependencies(this.__editorInfo,knownProperties),knownPropertiesCount=knownProperties.size,"invalid"===resolvedInfo.type)break;for(const[property,info]of resolvedInfo.properties)("optional"!==info.type||info.temporarilyRequired)&&knownProperties.add(property)}while(knownProperties.size!==knownPropertiesCount);if("invalid"===resolvedInfo.type)return void(this.__pauseChangeHandlers=!1);if(Helpers.SchemaParser.editorInfoEquivalent(resolvedInfo,this.__dependencyOverride))return void(this.__pauseChangeHandlers=!1);this.__dependencyOverride=resolvedInfo;const updateEditor=(editorEntry,editorInfo)=>{if(!Helpers.SchemaParser.editorInfoEquivalent(editorEntry.editor.getEditorInfo(),editorInfo))if(editorEntry.editor.getEditorInfo().type===editorInfo.type)editorEntry.editor.setEditorInfo(editorInfo);else{const value=editorEntry.editor.getRawValue();editorEntry.cell.innerHTML="",editorEntry.editor.destroy(),editorEntry.editor=this.__factory.fromEditorInfo(editorInfo,editorEntry.cell,this),editorEntry.editor.setIsReadOnly(this.__isReadOnly),editorEntry.editor.setSettings(this.__settings),editorEntry.editor.setValue(value)}},missingProperties=new Set(this.__editors.keys());for(const[name,editorInfo]of resolvedInfo.properties){missingProperties.delete(name);let entry=this.__editors.get(name);entry?updateEditor(entry,editorInfo):(entry=this.__createEditorRow(name,editorInfo,!0),this.__editorTable.appendChild(entry.row),this.__editors.set(name,entry))}for(const name of missingProperties){const entry=this.__editors.get(name);if(!entry)continue;updateEditor(entry,Helpers.ObjectEditor.getEditorInfoForProperty(resolvedInfo,name))}this.__addPropertyButton.setVisibility(!resolvedInfo.additionalProperties.editorInfo&&!resolvedInfo.patternProperties||this.__newPropertyContainer.classList.contains("show")?"Collapsed":"Visible"),this.__pauseChangeHandlers=!1,this.__onChangeManager.trigger(this,this.getState())}__createEditorRow(name,editorInfo,isAdditional){const row=document.createElement("tr"),nameCell=document.createElement("td");nameCell.classList.add("name-cell"),nameCell.textContent=name,row.appendChild(nameCell);const editorCell=document.createElement("td");editorCell.classList.add("value-cell"),row.appendChild(editorCell);const editor=this.__factory.fromEditorInfo(editorInfo,editorCell,this);editor.setIsReadOnly(this.__isReadOnly),editor.setSettings(this.__settings),editor.onChange.add(this.__onEditorChanged);const removeCell=document.createElement("td");removeCell.classList.add("remove-cell"),row.appendChild(removeCell);const ret={editor,row,cell:editorCell};if(isAdditional){const removeButton=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__name}.${name}RemoveButton`,{"data-tchmi-width":30,"data-tchmi-height":100,"data-tchmi-height-unit":"%","data-tchmi-tooltip":this.__removeButtonTooltip,"data-tchmi-is-enabled":this.__isEnabled&&!this.__isReadOnly},this.__parentControl);if(!removeButton)throw new Error("Could not create controls for object editor.");this.__childControls.add(removeButton);const destroyEvent=TcHmi.EventProvider.register(removeButton.getId()+".onPressed",this.__getRemoveButtonPressedHandler(name));this.__eventDestroyers.push(destroyEvent),ret.removeButton=removeButton,ret.additionalDestroyer=()=>{this.__childControls.delete(removeButton);const index=this.__eventDestroyers.indexOf(destroyEvent);-1!==index&&this.__eventDestroyers.splice(index,1),destroyEvent(),this.__parentControl&&this.__parentControl.__removeChild(removeButton),removeButton.destroy()};const removeButtonElement=removeButton.getElement()[0];removeButtonElement.classList.add(`${this.__className}-button-icon-remove`),removeCell.appendChild(removeButtonElement)}return ret}__onEditorChanged(editor){if(this.__pauseChangeHandlers)return;const state=this.getState();this.__onChangeManager.trigger(this,state),editor instanceof Helpers.OptionalEditor&&this.__applyDependencies(),this.__updateValidationStatus(state)}__getRemoveButtonPressedHandler(name){return()=>{if(this.__parentControl){if(!this.__parentControl.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this.__parentControl,"operate"))return}this.__removeEditorRow(name)}}__removeEditorRow(name){const editorEntry=this.__editors.get(name);if(editorEntry&&(editorEntry.editor.destroy(),editorEntry.row.remove(),editorEntry.additionalDestroyer?.(),this.__editors.delete(name),!this.__pauseChangeHandlers)){const state=this.getState();this.__onChangeManager.trigger(this,state),this.__applyDependencies(),this.__updateValidationStatus(state)}}__onAddPropertyPressed(){if(this.__parentControl){if(!this.__parentControl.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this.__parentControl,"operate"))return}this.__newPropertyContainer.classList.add("show"),this.__addPropertyButton.setVisibility("Collapsed"),this.__newPropertyTextbox.getElement()[0].querySelector("input")?.focus()}__onNewPropertyTextChanged(){if(this.__parentControl){if(!this.__parentControl.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this.__parentControl,"operate"))return}const name=this.__newPropertyTextbox.getText();if(!name)return this.__newPropertyTextbox.getElement()[0].classList.remove("invalid"),void this.__acceptNewPropertyButton.setIsEnabled(!1);!this.__editors.has(name)&&(this.__dependencyOverride.additionalProperties.allowed||this.__dependencyOverride.patternProperties&&Array.from(this.__dependencyOverride.patternProperties.keys()).some(pattern=>pattern.test(name)))?(this.__newPropertyTextbox.getElement()[0].classList.remove("invalid"),this.__acceptNewPropertyButton.setIsEnabled(!0)):(this.__newPropertyTextbox.getElement()[0].classList.add("invalid"),this.__acceptNewPropertyButton.setIsEnabled(!1))}__onAcceptNewPropertyPressed(){if(this.__parentControl){if(!this.__parentControl.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this.__parentControl,"operate"))return}const name=this.__newPropertyTextbox.getText();if(!name)return;let possibleEditors=[];if(this.__dependencyOverride.patternProperties&&(possibleEditors=Array.from(this.__dependencyOverride.patternProperties).filter(([pattern,_])=>pattern.test(name)).map(([_,info])=>info)),0===possibleEditors.length&&this.__dependencyOverride.additionalProperties.editorInfo&&(possibleEditors=[this.__dependencyOverride.additionalProperties.editorInfo]),0===possibleEditors.length)return;const editorEntry=this.__createEditorRow(name,Helpers.SchemaParser.mergeEditorInfos(...possibleEditors),!0);if(this.__editorTable.appendChild(editorEntry.row),this.__editors.set(name,editorEntry),this.__newPropertyTextbox.setText(null),this.__newPropertyContainer.classList.remove("show"),this.__addPropertyButton.setVisibility("Visible"),!this.__pauseChangeHandlers){const state=this.getState();this.__onChangeManager.trigger(this,state),this.__applyDependencies(),this.__updateValidationStatus(state)}}__onCancelNewPropertyPressed(){if(this.__parentControl){if(!this.__parentControl.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this.__parentControl,"operate"))return}this.__cancelNewProperty()}__cancelNewProperty(){this.__newPropertyTextbox.setText(null),this.__newPropertyContainer.classList.remove("show"),this.__addPropertyButton.setVisibility("Visible")}__onLocaleChanged(){this.__updateValidationStatus()}__updateValidationStatus(state=this.getState()){return this.__errorContainer.textContent=this.__buildValidationMessage(state),state.isValid}setIsEnabled(isEnabled){super.setIsEnabled(isEnabled),!isEnabled&&this.__newPropertyContainer.classList.contains("show")&&this.__cancelNewProperty(),this.__acceptNewPropertyButton.setIsEnabled(!1)}__processIsReadOnly(){for(const control of this.__childControls)control.setIsEnabled(this.__isEnabled&&!this.__isReadOnly);this.__isReadOnly&&this.__newPropertyContainer.classList.contains("show")&&this.__cancelNewProperty();for(const editorEntry of this.__editors.values())editorEntry.editor.setIsReadOnly(this.__isReadOnly)}setSettings(settings){super.setSettings(settings);for(const editorEntry of this.__editors.values())editorEntry.editor.setSettings(this.__settings)}setLocalizations(texts){if(super.setLocalizations(texts),this.__localizations){if(this.__localizations.objectEditorPane?.addButtonTooltip&&("string"==typeof this.__localizations.objectEditorPane.addButtonTooltip?(this.__unwatchLocalization("addButtonTooltip"),TcHmi.Binding.createEx2(this.__localizations.objectEditorPane.addButtonTooltip,"Tooltip",this.__addPropertyButton)):(TcHmi.Binding.removeEx2(null,"Tooltip",this.__addPropertyButton),this.__watchLocalization("addButtonTooltip",this.__localizations.objectEditorPane.addButtonTooltip,text=>this.__addPropertyButton.setTooltip(text)))),this.__localizations.objectEditorPane?.acceptButtonText&&("string"==typeof this.__localizations.objectEditorPane.acceptButtonText?(this.__unwatchLocalization("acceptButtonText"),TcHmi.Binding.createEx2(this.__localizations.objectEditorPane.acceptButtonText,"Text",this.__acceptNewPropertyButton)):(TcHmi.Binding.removeEx2(null,"Text",this.__acceptNewPropertyButton),this.__watchLocalization("acceptButtonText",this.__localizations.objectEditorPane.acceptButtonText,text=>this.__acceptNewPropertyButton.setText(text)))),this.__localizations.objectEditorPane?.acceptButtonTooltip&&("string"==typeof this.__localizations.objectEditorPane.acceptButtonTooltip?(this.__unwatchLocalization("acceptButtonTooltip"),TcHmi.Binding.createEx2(this.__localizations.objectEditorPane.acceptButtonTooltip,"Tooltip",this.__acceptNewPropertyButton)):(TcHmi.Binding.removeEx2(null,"Tooltip",this.__acceptNewPropertyButton),this.__watchLocalization("acceptButtonTooltip",this.__localizations.objectEditorPane.acceptButtonTooltip,text=>this.__acceptNewPropertyButton.setTooltip(text)))),this.__localizations.objectEditorPane?.cancelButtonTooltip&&("string"==typeof this.__localizations.objectEditorPane.cancelButtonTooltip?(this.__unwatchLocalization("cancelButtonTooltip"),TcHmi.Binding.createEx2(this.__localizations.objectEditorPane.cancelButtonTooltip,"Tooltip",this.__cancelNewPropertyButton)):(TcHmi.Binding.removeEx2(null,"Tooltip",this.__cancelNewPropertyButton),this.__watchLocalization("cancelButtonTooltip",this.__localizations.objectEditorPane.cancelButtonTooltip,text=>this.__cancelNewPropertyButton.setTooltip(text)))),this.__localizations.objectEditorPane?.removeButtonTooltip)if(this.__unwatchLocalization("removeButtonTooltip"),"string"==typeof this.__localizations.objectEditorPane.removeButtonTooltip){this.__removeButtonTooltip=this.__localizations.objectEditorPane.removeButtonTooltip;for(const editorEntry of this.__editors.values())editorEntry.removeButton&&TcHmi.Binding.createEx2(this.__localizations.objectEditorPane.removeButtonTooltip,"Tooltip",editorEntry.removeButton)}else{for(const editorEntry of this.__editors.values())editorEntry.removeButton&&TcHmi.Binding.removeEx2(null,"Tooltip",editorEntry.removeButton);this.__watchLocalization("removeButtonTooltip",this.__localizations.objectEditorPane.removeButtonTooltip,text=>{this.__removeButtonTooltip=text;for(const editorEntry of this.__editors.values())editorEntry.removeButton?.setTooltip(text)})}for(const editorEntry of this.__editors.values())editorEntry.editor.setLocalizations(this.__localizations)}}}})();Helpers.ObjectEditorPane=ObjectEditorPane}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){let OptionalEditor=(()=>{let ___onToggleStateChanged_decorators,___onEditorChanged_decorators,___onEditorConfirmed_decorators,_classSuper=Helpers.Editor,_instanceExtraInitializers=[];return class extends _classSuper{static{const _metadata="function"==typeof Symbol&&Symbol.metadata?Object.create(_classSuper[Symbol.metadata]??null):void 0;___onToggleStateChanged_decorators=[TcHmi.CallbackMethod],___onEditorChanged_decorators=[TcHmi.CallbackMethod],___onEditorConfirmed_decorators=[TcHmi.CallbackMethod],__esDecorate(this,null,___onToggleStateChanged_decorators,{kind:"method",name:"__onToggleStateChanged",static:!1,private:!1,access:{has:obj=>"__onToggleStateChanged"in obj,get:obj=>obj.__onToggleStateChanged},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onEditorChanged_decorators,{kind:"method",name:"__onEditorChanged",static:!1,private:!1,access:{has:obj=>"__onEditorChanged"in obj,get:obj=>obj.__onEditorChanged},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onEditorConfirmed_decorators,{kind:"method",name:"__onEditorConfirmed",static:!1,private:!1,access:{has:obj=>"__onEditorConfirmed"in obj,get:obj=>obj.__onEditorConfirmed},metadata:_metadata},null,_instanceExtraInitializers),_metadata&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_metadata})}__container=__runInitializers(this,_instanceExtraInitializers);__editor;__checkbox;__enteredValue=null;constructor(element,editorInfo,factory){super(element,editorInfo,factory),this.__container=document.createElement("div"),this.__container.classList.add("compound-control-container"),this.__editor=this.__factory.fromEditorInfo(editorInfo.editorInfo,this.__container,this),this.__editor.onChange.add(this.__onEditorChanged),this.__editor.onConfirm.add(this.__onEditorConfirmed),this.__editor.setIsEnabled(editorInfo.temporarilyRequired);const checkbox=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiCheckbox",`${this.__name}.checkbox`,{"data-tchmi-width":30,"data-tchmi-height":100,"data-tchmi-height-unit":"%","data-tchmi-toggle-state":editorInfo.temporarilyRequired?"Active":"Normal"},this.__parentControl);if(!checkbox)throw new Error("Could not create controls for optional editor.");this.__checkbox=checkbox,this.__childControls.add(checkbox),this.__eventDestroyers.push(TcHmi.EventProvider.register(checkbox.getId()+".onToggleStateChanged",this.__onToggleStateChanged));const checkboxElement=checkbox.getElement()[0];checkboxElement.classList.add("with-validation"),this.__container.appendChild(checkboxElement),element.appendChild(this.__container)}destroy(){TcHmi.Binding.removeEx2(null,"Tooltip",this.__checkbox),super.destroy()}setEditorInfo(editorInfo){!this.__editorInfo.temporarilyRequired&&editorInfo.temporarilyRequired&&this.__checkbox.setToggleState("Active"),super.setEditorInfo(editorInfo)}__processEditorInfo(){if(this.__editor.getEditorInfo().type===this.__editorInfo.editorInfo.type)this.__editor.setEditorInfo(this.__editorInfo.editorInfo);else{const value=this.__editor.getRawValue();this.__container.innerHTML="",this.__editor.destroy(),this.__editor=this.__factory.fromEditorInfo(this.__editorInfo.editorInfo,this.__container,this),this.__editor.setIsReadOnly(this.__isReadOnly),this.__editor.setSettings(this.__settings),this.__editor.setValue(value),this.__editor.onChange.add(this.__onEditorChanged),this.__editor.onConfirm.add(this.__onEditorConfirmed),this.__container.appendChild(this.__checkbox.getElement()[0])}this.__onToggleStateChanged()}__processIsReadOnly(){this.__checkbox.setIsEnabled(this.__isEnabled&&!this.__isReadOnly),this.__editor.setIsReadOnly(this.__isReadOnly)}setSettings(settings){super.setSettings(settings),this.__editor.setSettings(this.__settings)}__onToggleStateChanged(){const toggleStateActive="Active"===this.__checkbox.getToggleState();this.__editor.setIsEnabled(toggleStateActive),void 0!==this.__editorInfo.valueIfDisabled&&(toggleStateActive?(this.__editor.setValue(this.__enteredValue??this.__editorInfo.editorInfo.defaultValue??this.__editorInfo.valueIfDisabled??null),this.__enteredValue=null):(this.__enteredValue=this.__editor.getRawValue(),this.__editor.setValue(this.__editorInfo.valueIfDisabled))),this.__checkbox.getElement()[0].classList.toggle("invalid",this.__editorInfo.temporarilyRequired&&!toggleStateActive),this.__onChangeManager.trigger(this,this.getState())}__onEditorChanged(_editor,state){this.__onChangeManager.trigger(this,state)}__onEditorConfirmed(_editor,state){this.__onConfirmManager.trigger(this,state)}static validate(editorInfo,value){return void 0===value?!editorInfo.temporarilyRequired:Helpers.Editor.validate(editorInfo.editorInfo,value)}static checkForErrors(editorInfo,value,returnEarly=!1){return void 0===value?editorInfo.temporarilyRequired?[{error:Helpers.Editor.Error.OPTIONAL_TEMPORARILY_REQUIRED,parameters:[value]}]:[]:Helpers.Editor.checkForErrors(editorInfo.editorInfo,value,returnEarly)}setValue(value){void 0===value?(void 0!==this.__editorInfo.valueIfDisabled&&"Normal"===this.__checkbox.getToggleState()&&this.__editor.setValue(this.__editorInfo.valueIfDisabled),this.__checkbox.setToggleState("Normal")):(this.__checkbox.setToggleState("Active"),this.__editor.setValue(value))}getRawValue(){return"Normal"===this.__checkbox.getToggleState()?void 0:this.__editor.getRawValue()}setLocalizations(texts){super.setLocalizations(texts),this.__localizations&&(this.__localizations.optionalEditor?.optionalCheckboxTooltip&&("string"==typeof this.__localizations.optionalEditor.optionalCheckboxTooltip?(this.__unwatchLocalization("optionalCheckboxTooltip"),TcHmi.Binding.createEx2(this.__localizations.optionalEditor.optionalCheckboxTooltip,"Tooltip",this.__checkbox)):(TcHmi.Binding.removeEx2(null,"Tooltip",this.__checkbox),this.__watchLocalization("optionalCheckboxTooltip",this.__localizations.optionalEditor.optionalCheckboxTooltip,text=>this.__checkbox.setTooltip(text)))),this.__editor.setLocalizations(this.__localizations))}}})();Helpers.OptionalEditor=OptionalEditor}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){class ArrayEditor extends Helpers.ButtonBasedEditor{__value=[];constructor(element,editorInfo,factory){super(element,editorInfo,factory),this.__processEditorInfo()}destroy(){super.destroy(),this.__popup?.destroy(!0)}static validate(editorInfo,value){return 0===ArrayEditor.checkForErrors(editorInfo,value,!0).length}static checkForErrors(editorInfo,value,returnEarly=!1){if(!Array.isArray(value))return[{error:Helpers.Editor.Error.NOT_AN_ARRAY,parameters:[value]}];if(null!==Object.getPrototypeOf(value)&&Object.getPrototypeOf(value)!==Object.getPrototypeOf([]))return[{error:Helpers.Editor.Error.ARRAY_HAS_INVALID_PROTOTYPE,parameters:[value]}];const errors=[];if(void 0!==editorInfo.minItems&&value.length<editorInfo.minItems&&(errors.push({error:Helpers.Editor.Error.ARRAY_HAS_TOO_FEW_ITEMS,parameters:[value,editorInfo.minItems,value.length]}),returnEarly))return errors;if(void 0!==editorInfo.maxItems&&value.length>editorInfo.maxItems&&(errors.push({error:Helpers.Editor.Error.ARRAY_HAS_TOO_MANY_ITEMS,parameters:[value,editorInfo.maxItems,value.length]}),returnEarly))return errors;for(const[index,item]of value.entries()){const underlyingErrors=Helpers.Editor.checkForErrors(editorInfo.items,item,returnEarly);if(underlyingErrors.length>0&&(errors.push({error:Helpers.Editor.Error.ARRAY_CONTAINS_INVALID_VALUE,parameters:[value,index],underlying:underlyingErrors}),returnEarly))return errors}if(editorInfo.uniqueItems)for(let i=0,ii=value.length-1;i<ii;i++){const duplicateIndices=[i];for(let j=i+1,jj=value.length;j<jj;j++)if(tchmi_equal(value[i],value[j],{compareDates:!0})&&(duplicateIndices.push(j),returnEarly))return[{error:Helpers.Editor.Error.ARRAY_CONTAINS_DUPLICATE_ITEMS,parameters:[value,duplicateIndices]}];duplicateIndices.length>1&&errors.push({error:Helpers.Editor.Error.ARRAY_CONTAINS_DUPLICATE_ITEMS,parameters:[value,duplicateIndices]})}return errors}__processEditorInfo(){this.__popup?.setEditorInfo(this.__editorInfo),this.__textSpan.textContent=this.__editorInfo.name,this.__container.classList.toggle("invalid",!this.getState().isValid)}setValue(value){this.__value=value??[],this.__popup?.setValue(value);const state=this.getState();this.__container.classList.toggle("invalid",!state.isValid),this.__onChangeManager.trigger(this,state)}getRawValue(){return this.__value}async openPopup(){this.__popup||(this.__popup=new Helpers.ArrayEditorPrompt(this.__editorInfo,this.__factory),this.__popup.setBackgroundAction({close:!0,action:"cancel"}),this.__popup.setIsReadOnly(this.__isReadOnly),this.__popup.setSettings(this.__settings),this.__popup.setLocalizations({buttonTextOk:this.__localizations?.arrayEditorPrompt?.buttonTextOk??this.__localizations?.editorPrompt?.buttonTextOk,buttonTooltipOk:this.__localizations?.arrayEditorPrompt?.buttonTooltipOk??this.__localizations?.editorPrompt?.buttonTooltipOk,buttonTextCancel:this.__localizations?.arrayEditorPrompt?.buttonTextCancel??this.__localizations?.editorPrompt?.buttonTextCancel,buttonTooltipCancel:this.__localizations?.arrayEditorPrompt?.buttonTooltipCancel??this.__localizations?.editorPrompt?.buttonTooltipCancel,editorLocalizations:this.__localizations}));try{this.__popup.setValue(this.__value);const result=await this.__popup.prompt();if(result.isOk){this.__value=result.value;const state=this.getState();this.__container.classList.toggle("invalid",!state.isValid),this.__onChangeManager.trigger(this,state),state.isValid&&this.__onConfirmManager.trigger(this,state)}}catch(ex){}}setLocalizations(texts){super.setLocalizations(texts),this.__popup?.setLocalizations({buttonTextOk:this.__localizations?.arrayEditorPrompt?.buttonTextOk??this.__localizations?.editorPrompt?.buttonTextOk,buttonTooltipOk:this.__localizations?.arrayEditorPrompt?.buttonTooltipOk??this.__localizations?.editorPrompt?.buttonTooltipOk,buttonTextCancel:this.__localizations?.arrayEditorPrompt?.buttonTextCancel??this.__localizations?.editorPrompt?.buttonTextCancel,buttonTooltipCancel:this.__localizations?.arrayEditorPrompt?.buttonTooltipCancel??this.__localizations?.editorPrompt?.buttonTooltipCancel,editorLocalizations:this.__localizations})}}Helpers.ArrayEditor=ArrayEditor}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){let ArrayBasedEditorPane=(()=>{let ___onEditorChanged_decorators,___onClick_decorators,___onAddItemPressed_decorators,___onUpPressed_decorators,___onDownPressed_decorators,___onLocaleChanged_decorators,_classSuper=Helpers.Editor,_instanceExtraInitializers=[];return class extends _classSuper{static{const _metadata="function"==typeof Symbol&&Symbol.metadata?Object.create(_classSuper[Symbol.metadata]??null):void 0;___onEditorChanged_decorators=[TcHmi.CallbackMethod],___onClick_decorators=[TcHmi.CallbackMethod],___onAddItemPressed_decorators=[TcHmi.CallbackMethod],___onUpPressed_decorators=[TcHmi.CallbackMethod],___onDownPressed_decorators=[TcHmi.CallbackMethod],___onLocaleChanged_decorators=[TcHmi.CallbackMethod],__esDecorate(this,null,___onEditorChanged_decorators,{kind:"method",name:"__onEditorChanged",static:!1,private:!1,access:{has:obj=>"__onEditorChanged"in obj,get:obj=>obj.__onEditorChanged},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onClick_decorators,{kind:"method",name:"__onClick",static:!1,private:!1,access:{has:obj=>"__onClick"in obj,get:obj=>obj.__onClick},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onAddItemPressed_decorators,{kind:"method",name:"__onAddItemPressed",static:!1,private:!1,access:{has:obj=>"__onAddItemPressed"in obj,get:obj=>obj.__onAddItemPressed},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onUpPressed_decorators,{kind:"method",name:"__onUpPressed",static:!1,private:!1,access:{has:obj=>"__onUpPressed"in obj,get:obj=>obj.__onUpPressed},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onDownPressed_decorators,{kind:"method",name:"__onDownPressed",static:!1,private:!1,access:{has:obj=>"__onDownPressed"in obj,get:obj=>obj.__onDownPressed},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onLocaleChanged_decorators,{kind:"method",name:"__onLocaleChanged",static:!1,private:!1,access:{has:obj=>"__onLocaleChanged"in obj,get:obj=>obj.__onLocaleChanged},metadata:_metadata},null,_instanceExtraInitializers),_metadata&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_metadata})}__editorTable=__runInitializers(this,_instanceExtraInitializers);__addItemButton;__upButton;__downButton;__removeButtonTooltip="";__errorContainer;__editors=[];__selectedEditorEntry=null;__pauseChangeHandlers=!1;constructor(element,editorInfo,factory){super(element,editorInfo,factory),this.__editorTable=document.createElement("table"),this.__editorTable.classList.add(`${this.__className}-editor-table`),this.__element.appendChild(this.__editorTable);const addItemButton=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__name}.AddItemButton`,{"data-tchmi-width":30,"data-tchmi-height":30},this.__parentControl),upButton=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__name}.UpButton`,{"data-tchmi-width":30,"data-tchmi-height":30,"data-tchmi-is-enabled":!1},this.__parentControl),downButton=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__name}.DownButton`,{"data-tchmi-width":30,"data-tchmi-height":30,"data-tchmi-is-enabled":!1},this.__parentControl);if(!addItemButton||!upButton||!downButton)throw new Error("Could not create controls for array editor.");const buttonContainer=document.createElement("div");buttonContainer.classList.add(`${this.__className}-editor-table-buttons`),this.__addItemButton=addItemButton,this.__childControls.add(addItemButton);addItemButton.getElement()[0].classList.add(`${this.__className}-button-icon-add`),buttonContainer.appendChild(addItemButton.getElement()[0]),this.__upButton=upButton,this.__childControls.add(upButton);upButton.getElement()[0].classList.add(`${this.__className}-button-icon-up`),buttonContainer.appendChild(upButton.getElement()[0]),this.__downButton=downButton,this.__childControls.add(downButton);downButton.getElement()[0].classList.add(`${this.__className}-button-icon-down`),buttonContainer.appendChild(downButton.getElement()[0]),this.__element.appendChild(buttonContainer),this.__errorContainer=document.createElement("div"),this.__errorContainer.classList.add("validation-errors"),this.__element.appendChild(this.__errorContainer),this.__eventDestroyers.push(TcHmi.EventProvider.register(addItemButton.getId()+".onPressed",this.__onAddItemPressed),TcHmi.EventProvider.register(upButton.getId()+".onPressed",this.__onUpPressed),TcHmi.EventProvider.register(downButton.getId()+".onPressed",this.__onDownPressed),TcHmi.EventProvider.registerDomEvent(this.__element,"click",this.__onClick,{passive:!0}),TcHmi.EventProvider.register("onLocaleChanged",this.__onLocaleChanged)),this.__processEditorInfo()}destroy(){TcHmi.Binding.removeEx2(null,"Tooltip",this.__addItemButton),TcHmi.Binding.removeEx2(null,"Tooltip",this.__upButton),TcHmi.Binding.removeEx2(null,"Tooltip",this.__downButton);for(const editorEntry of this.__editors)editorEntry.editor.destroy(),editorEntry.removeButton&&TcHmi.Binding.removeEx2(null,"Tooltip",editorEntry.removeButton);this.__editors=[],super.destroy()}getRawValue(){const value=[];for(const entry of this.__editors){const rawValue=entry.editor.getRawValue();void 0!==rawValue&&value.push(rawValue)}return value}__createEditorRow(editorInfo,removable=!0){const row=document.createElement("tr"),indexCell=document.createElement("td");indexCell.classList.add("name-cell","auto-increment-index"),row.appendChild(indexCell);const editorCell=document.createElement("td");editorCell.classList.add("value-cell"),row.appendChild(editorCell);const editor=this.__factory.fromEditorInfo(editorInfo,editorCell,this);editor.setIsReadOnly(this.__isReadOnly),editor.setSettings(this.__settings),editor.onChange.add(this.__onEditorChanged);const removeCell=document.createElement("td");removeCell.classList.add("remove-cell"),row.appendChild(removeCell);const ret={editor,row,cell:editorCell};if(removable){const removeButton=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__name}.${tchmi_create_guid()}_RemoveButton`,{"data-tchmi-width":30,"data-tchmi-height":100,"data-tchmi-height-unit":"%","data-tchmi-tooltip":this.__removeButtonTooltip,"data-tchmi-is-enabled":this.__isEnabled&&!this.__isReadOnly},this.__parentControl);if(!removeButton)throw new Error("Could not create controls for array editor.");this.__childControls.add(removeButton);const destroyEvent=TcHmi.EventProvider.register(removeButton.getId()+".onPressed",this.__getRemoveButtonPressedHandler(ret));this.__eventDestroyers.push(destroyEvent),ret.removeButton=removeButton,ret.removeDestroyer=()=>{this.__childControls.delete(removeButton);const index=this.__eventDestroyers.indexOf(destroyEvent);-1!==index&&this.__eventDestroyers.splice(index,1),destroyEvent(),this.__parentControl&&this.__parentControl.__removeChild(removeButton),removeButton.destroy()};const removeButtonElement=removeButton.getElement()[0];removeButtonElement.classList.add(`${this.__className}-button-icon-remove`),removeCell.appendChild(removeButtonElement)}return ret}__onEditorChanged(editor){this.__handleOnEditorChanged(editor)}__handleOnEditorChanged(_editor){this.__pauseChangeHandlers||(this.__onChangeManager.trigger(this,this.getState()),this.__updateValidationStatus())}__getRemoveButtonPressedHandler(entry){return()=>{if(this.__parentControl){if(!this.__parentControl.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this.__parentControl,"operate"))return}this.__removeEditorRow(entry)}}__removeEditorRow(editorEntry){this.__selectedEditorEntry===editorEntry&&this.__selectItem(null),editorEntry.editor.destroy(),editorEntry.row.remove(),editorEntry.removeDestroyer?.();const index=this.__editors.indexOf(editorEntry);if(-1!==index&&this.__editors.splice(index,1),!this.__pauseChangeHandlers){const state=this.getState();this.__onChangeManager.trigger(this,state),this.__updateValidationStatus(state)}}__selectItem(editorEntry){this.__selectedEditorEntry!==editorEntry&&(this.__selectedEditorEntry?.row.classList.remove("selected"),this.__selectedEditorEntry=editorEntry,this.__selectedEditorEntry?.row.classList.add("selected")),this.__updateMoveButtons(editorEntry?this.__editors.indexOf(editorEntry):-1)}__updateMoveButtons(selectedIndex){this.__isEnabled&&!this.__isReadOnly&&(this.__upButton.setIsEnabled(-1!==selectedIndex&&selectedIndex>0),this.__downButton.setIsEnabled(-1!==selectedIndex&&selectedIndex<this.__editors.length-1))}__onClick(event){if(this.__parentControl){if(!this.__parentControl.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this.__parentControl,"operate"))return}if(!(event.target instanceof Element)||event.target.closest('div[data-tchmi-type="TcHmi.Controls.Beckhoff.TcHmiButton"]'))return;const row=event.target.closest("tr"),editorEntry=this.__editors.find(entry=>entry.row===row);this.__selectItem(editorEntry??null)}__onAddItemPressed(){if(this.__parentControl){if(!this.__parentControl.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this.__parentControl,"operate"))return}this.__addItem(),this.__updateValidationStatus()}__onUpPressed(){if(this.__parentControl){if(!this.__parentControl.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this.__parentControl,"operate"))return}if(!this.__selectedEditorEntry||!this.__selectedEditorEntry.row.previousElementSibling)return;const currentIndex=this.__editors.indexOf(this.__selectedEditorEntry);if(-1===currentIndex||0===currentIndex)return;this.__selectedEditorEntry.row.previousElementSibling.insertAdjacentElement("beforebegin",this.__selectedEditorEntry.row),this.__editors.splice(currentIndex-1,0,...this.__editors.splice(currentIndex,1));const state=this.getState();this.__onChangeManager.trigger(this,state),this.__updateValidationStatus(state),this.__selectItem(this.__selectedEditorEntry)}__onDownPressed(){if(this.__parentControl){if(!this.__parentControl.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this.__parentControl,"operate"))return}if(!this.__selectedEditorEntry||!this.__selectedEditorEntry.row.nextElementSibling)return;const currentIndex=this.__editors.indexOf(this.__selectedEditorEntry);if(-1===currentIndex||currentIndex===this.__editors.length-1)return;this.__selectedEditorEntry.row.nextElementSibling.insertAdjacentElement("afterend",this.__selectedEditorEntry.row),this.__editors.splice(currentIndex+1,0,...this.__editors.splice(currentIndex,1));const state=this.getState();this.__onChangeManager.trigger(this,state),this.__updateValidationStatus(state),this.__selectItem(this.__selectedEditorEntry)}__onLocaleChanged(){this.__updateValidationStatus()}__updateValidationStatus(state=this.getState()){return this.__errorContainer.textContent=this.__buildValidationMessage(state),state.isValid}setIsEnabled(isEnabled){super.setIsEnabled(isEnabled),this.__selectItem(this.__selectedEditorEntry)}__processIsReadOnly(){for(const control of this.__childControls)control.setIsEnabled(this.__isEnabled&&!this.__isReadOnly);this.__selectItem(this.__selectedEditorEntry);for(const editorEntry of this.__editors)editorEntry.editor.setIsReadOnly(this.__isReadOnly)}setSettings(settings){super.setSettings(settings);for(const editorEntry of this.__editors)editorEntry.editor.setSettings(this.__settings)}setLocalizations(texts){if(super.setLocalizations(texts),this.__localizations){if(this.__localizations.arrayBasedEditorPane?.addButtonTooltip&&("string"==typeof this.__localizations.arrayBasedEditorPane.addButtonTooltip?(this.__unwatchLocalization("addButtonTooltip"),TcHmi.Binding.createEx2(this.__localizations.arrayBasedEditorPane.addButtonTooltip,"Tooltip",this.__addItemButton)):(TcHmi.Binding.removeEx2(null,"Tooltip",this.__addItemButton),this.__watchLocalization("addButtonTooltip",this.__localizations.arrayBasedEditorPane.addButtonTooltip,text=>this.__addItemButton.setTooltip(text)))),this.__localizations.arrayBasedEditorPane?.upButtonTooltip&&("string"==typeof this.__localizations.arrayBasedEditorPane.upButtonTooltip?(this.__unwatchLocalization("upButtonTooltip"),TcHmi.Binding.createEx2(this.__localizations.arrayBasedEditorPane.upButtonTooltip,"Tooltip",this.__upButton)):(TcHmi.Binding.removeEx2(null,"Tooltip",this.__upButton),this.__watchLocalization("upButtonTooltip",this.__localizations.arrayBasedEditorPane.upButtonTooltip,text=>this.__upButton.setTooltip(text)))),this.__localizations.arrayBasedEditorPane?.downButtonTooltip&&("string"==typeof this.__localizations.arrayBasedEditorPane.downButtonTooltip?(this.__unwatchLocalization("downButtonTooltip"),TcHmi.Binding.createEx2(this.__localizations.arrayBasedEditorPane.downButtonTooltip,"Tooltip",this.__downButton)):(TcHmi.Binding.removeEx2(null,"Tooltip",this.__downButton),this.__watchLocalization("downButtonTooltip",this.__localizations.arrayBasedEditorPane.downButtonTooltip,text=>this.__downButton.setTooltip(text)))),this.__localizations.arrayBasedEditorPane?.removeButtonTooltip)if("string"==typeof this.__localizations.arrayBasedEditorPane.removeButtonTooltip){this.__unwatchLocalization("removeButtonTooltip"),this.__removeButtonTooltip=this.__localizations.arrayBasedEditorPane.removeButtonTooltip;for(const editorEntry of this.__editors)editorEntry.removeButton&&TcHmi.Binding.createEx2(this.__localizations.arrayBasedEditorPane.removeButtonTooltip,"Tooltip",editorEntry.removeButton)}else{for(const editorEntry of this.__editors)editorEntry.removeButton&&TcHmi.Binding.removeEx2(null,"Tooltip",editorEntry.removeButton);this.__watchLocalization("removeButtonTooltip",this.__localizations.arrayBasedEditorPane.removeButtonTooltip,text=>{this.__removeButtonTooltip=text;for(const editorEntry of this.__editors)editorEntry.removeButton?.setTooltip(text)})}for(const editorEntry of this.__editors)editorEntry.editor.setLocalizations(this.__localizations)}}}})();Helpers.ArrayBasedEditorPane=ArrayBasedEditorPane}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){class ArrayEditorPane extends Helpers.ArrayBasedEditorPane{constructor(element,editorInfo,factory){super(element,editorInfo,factory)}__processEditorInfo(){const value=this.getRawValue();this.__editorTable.innerHTML="";for(const entry of this.__editors)this.__removeEditorRow(entry);this.setValue(value)}setValue(value){this.__pauseChangeHandlers=!0,value||(value=[]);let index=0;for(let length=value.length;index<length;index++){let editorEntry=this.__editors[index];editorEntry||(editorEntry=this.__createEditorRow(this.__editorInfo.items),this.__editorTable.appendChild(editorEntry.row),this.__editors.push(editorEntry)),editorEntry.editor.setValue(value[index])}if(index<this.__editors.length){const deletedEditors=this.__editors.splice(index);for(const entry of deletedEditors)this.__removeEditorRow(entry)}this.__pauseChangeHandlers=!1;const state=this.getState();this.__onChangeManager.trigger(this,state),this.__updateValidationStatus(state)}__addItem(){const editorEntry=this.__createEditorRow(this.__editorInfo.items);this.__editorTable.appendChild(editorEntry.row),this.__editors.push(editorEntry),this.__pauseChangeHandlers||this.__onChangeManager.trigger(this,this.getState()),this.__selectItem(editorEntry)}}Helpers.ArrayEditorPane=ArrayEditorPane}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){class TupleEditor extends Helpers.ButtonBasedEditor{__value=[];constructor(element,editorInfo,factory){super(element,editorInfo,factory),this.__processEditorInfo()}destroy(){super.destroy(),this.__popup?.destroy(!0)}static validate(editorInfo,value){return 0===TupleEditor.checkForErrors(editorInfo,value,!0).length}static checkForErrors(editorInfo,value,returnEarly=!1){const arrayEditorInfo={type:"array",schema:editorInfo.schema,name:editorInfo.name,items:Helpers.ChoiceEditor.createAnyEditorInfo(),uniqueItems:editorInfo.uniqueItems};void 0!==editorInfo.minItems&&(arrayEditorInfo.minItems=editorInfo.minItems),void 0!==editorInfo.maxItems&&(arrayEditorInfo.maxItems=editorInfo.maxItems);const errors=Helpers.ArrayEditor.checkForErrors(arrayEditorInfo,value,returnEarly);if(returnEarly&&errors.length>0)return errors;if(!Array.isArray(value))return errors.length>0?errors:[{error:Helpers.Editor.Error.NOT_AN_ARRAY,parameters:[value]}];for(const[index,item]of value.entries())if(index<editorInfo.items.length){const underlyingErrors=Helpers.Editor.checkForErrors(editorInfo.items[index],item,returnEarly);if(underlyingErrors.length>0&&(errors.push({error:Helpers.Editor.Error.ARRAY_CONTAINS_INVALID_VALUE,parameters:[value,index],underlying:underlyingErrors}),returnEarly))return errors}else if(editorInfo.additionalItems.allowed){if(editorInfo.additionalItems.editorInfo){const underlyingErrors=Helpers.Editor.checkForErrors(editorInfo.additionalItems.editorInfo,item,returnEarly);if(underlyingErrors.length>0&&(errors.push({error:Helpers.Editor.Error.OBJECT_CONTAINS_INVALID_VALUE,parameters:[value,index],underlying:underlyingErrors}),returnEarly))return errors}}else if(errors.push({error:Helpers.Editor.Error.ARRAY_HAS_TOO_MANY_ITEMS,parameters:[value,editorInfo.items.length,value.length]}),returnEarly)return errors;return errors}__processEditorInfo(){this.__popup?.setEditorInfo(this.__editorInfo),this.__textSpan.textContent=this.__editorInfo.name,this.__container.classList.toggle("invalid",!this.getState().isValid)}setValue(value){this.__value=value??[],this.__popup?.setValue(value);const state=this.getState();this.__container.classList.toggle("invalid",!state.isValid),this.__onChangeManager.trigger(this,state)}getRawValue(){return this.__value}async openPopup(){this.__popup||(this.__popup=new Helpers.TupleEditorPrompt(this.__editorInfo,this.__factory),this.__popup.setBackgroundAction({close:!0,action:"cancel"}),this.__popup.setIsReadOnly(this.__isReadOnly),this.__popup.setSettings(this.__settings),this.__popup.setLocalizations({buttonTextOk:this.__localizations?.tupleEditorPrompt?.buttonTextOk??this.__localizations?.editorPrompt?.buttonTextOk,buttonTooltipOk:this.__localizations?.tupleEditorPrompt?.buttonTooltipOk??this.__localizations?.editorPrompt?.buttonTooltipOk,buttonTextCancel:this.__localizations?.tupleEditorPrompt?.buttonTextCancel??this.__localizations?.editorPrompt?.buttonTextCancel,buttonTooltipCancel:this.__localizations?.tupleEditorPrompt?.buttonTooltipCancel??this.__localizations?.editorPrompt?.buttonTooltipCancel,editorLocalizations:this.__localizations}));try{this.__popup.setValue(this.__value);const result=await this.__popup.prompt();if(result.isOk){this.__value=result.value;const state=this.getState();this.__container.classList.toggle("invalid",!state.isValid),this.__onChangeManager.trigger(this,state),state.isValid&&this.__onConfirmManager.trigger(this,state)}}catch(ex){}}setLocalizations(texts){super.setLocalizations(texts),this.__popup?.setLocalizations({buttonTextOk:this.__localizations?.tupleEditorPrompt?.buttonTextOk??this.__localizations?.editorPrompt?.buttonTextOk,buttonTooltipOk:this.__localizations?.tupleEditorPrompt?.buttonTooltipOk??this.__localizations?.editorPrompt?.buttonTooltipOk,buttonTextCancel:this.__localizations?.tupleEditorPrompt?.buttonTextCancel??this.__localizations?.editorPrompt?.buttonTextCancel,buttonTooltipCancel:this.__localizations?.tupleEditorPrompt?.buttonTooltipCancel??this.__localizations?.editorPrompt?.buttonTooltipCancel,editorLocalizations:this.__localizations})}}Helpers.TupleEditor=TupleEditor}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){class TupleEditorPane extends Helpers.ArrayBasedEditorPane{constructor(element,editorInfo,factory){super(element,editorInfo,factory)}__processEditorInfo(){const value=this.getRawValue();this.__editorTable.innerHTML="";for(const entry of this.__editors)this.__removeEditorRow(entry);for(const item of this.__editorInfo.items){const editorEntry=this.__createEditorRow(item,!1);this.__editorTable.appendChild(editorEntry.row),this.__editors.push(editorEntry)}this.setValue(value),this.__addItemButton.setVisibility(this.__editorInfo.additionalItems.allowed&&this.__editorInfo.additionalItems.editorInfo?"Visible":"Hidden")}setValue(value){this.__pauseChangeHandlers=!0,value||(value=[]);let index=0;for(let length=value.length;index<length;index++){let editorEntry=this.__editors[index];if(!editorEntry){let info;info=this.__editorInfo.additionalItems.allowed?this.__editorInfo.additionalItems.editorInfo??Helpers.ChoiceEditor.createAnyEditorInfo():{type:"invalid",schema:{},name:"Invalid"},editorEntry=this.__createEditorRow(info),this.__editorTable.appendChild(editorEntry.row),this.__editors.push(editorEntry)}editorEntry.editor.setValue(value[index])}for(;index<this.__editorInfo.items.length;)this.__editors[index].editor.setValue(void 0),index++;if(index<this.__editors.length){const deletedEditors=this.__editors.splice(index);for(const entry of deletedEditors)this.__removeEditorRow(entry)}this.__pauseChangeHandlers=!1;const state=this.getState();this.__onChangeManager.trigger(this,state),this.__updateValidationStatus(state)}__markRequired(){this.__pauseChangeHandlers=!0;let triggerChangeHandlers=!1,shouldBeRequired=this.__editors.length>this.__editorInfo.items.length;for(let i=this.__editorInfo.items.length-1;i>=0;i--){const editor=this.__editors[i].editor;let editorInfo=this.__editors[i].editor.getEditorInfo();if("optional"!==editorInfo.type)break;editorInfo.temporarilyRequired!==shouldBeRequired&&(editorInfo=tchmi_clone_object(editorInfo),editorInfo.temporarilyRequired=shouldBeRequired,editor.setEditorInfo(editorInfo),triggerChangeHandlers=!0),shouldBeRequired||void 0===editor.getRawValue()||(shouldBeRequired=!0)}this.__pauseChangeHandlers=!1,triggerChangeHandlers&&this.__onChangeManager.trigger(this,this.getState())}__handleOnEditorChanged(editor){super.__handleOnEditorChanged(editor),this.__markRequired()}__addItem(){if(!this.__editorInfo.additionalItems.allowed)return;const info=this.__editorInfo.additionalItems.editorInfo??Helpers.ChoiceEditor.createAnyEditorInfo(),editorEntry=this.__createEditorRow(info);this.__editorTable.appendChild(editorEntry.row),this.__editors.push(editorEntry),this.__pauseChangeHandlers||this.__onChangeManager.trigger(this,this.getState()),this.__markRequired(),this.__selectItem(editorEntry)}__removeEditorRow(editorEntry){super.__removeEditorRow(editorEntry),this.__markRequired()}__updateMoveButtons(selectedIndex){this.__upButton.setIsEnabled(-1!==selectedIndex&&selectedIndex>this.__editorInfo.items.length),this.__downButton.setIsEnabled(-1!==selectedIndex&&selectedIndex>=this.__editorInfo.items.length&&selectedIndex<this.__editors.length-1)}}Helpers.TupleEditorPane=TupleEditorPane}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){class NullEditor extends Helpers.Editor{__onChangeTriggered=!1;constructor(element,editorInfo,factory){super(element,editorInfo,factory);const textSpan=document.createElement("span");textSpan.classList.add("value-description"),textSpan.textContent="null",this.__element.appendChild(textSpan)}static validate(_editorInfo,value){return null===value}static checkForErrors(_editorInfo,value,_returnEarly=!1){return null!==value?[{error:Helpers.Editor.Error.NOT_NULL}]:[]}__processEditorInfo(){}__processIsReadOnly(){}setValue(_value){this.__onChangeTriggered||(this.__onChangeTriggered=!0,this.__onChangeManager.trigger(this,this.getState()))}getRawValue(){return null}}Helpers.NullEditor=NullEditor}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){class InvalidEditor extends Helpers.Editor{static#tchmiFQN="TcHmi.Controls.Helpers."+this.name;__value;__textContainer;constructor(element,editorInfo,factory){super(element,editorInfo,factory),this.__textContainer=document.createElement("span"),this.__textContainer.classList.add("with-validation","invalid"),this.__element.appendChild(this.__textContainer),this.__parentControl?TcHmi.Log.Controls.error(this.__parentControl,InvalidEditor.#tchmiFQN,"Failed to construct an editor because the JSON schema is invalid.",editorInfo.schema):TcHmi.Log.errorEx(`[Source=Control, Module=Beckhoff.TwinCAT.HMI.Controls, Origin=${InvalidEditor.#tchmiFQN}] Failed to construct an editor because the JSON schema is invalid.`,editorInfo.schema)}static validate(_editorInfo,_value){return!1}static checkForErrors(_editorInfo,_value,_returnEarly=!1){return[{error:Helpers.Editor.Error.ERROR}]}__processEditorInfo(){}__processIsReadOnly(){}setValue(value){tchmi_equal(this.__value,value)||(this.__value=value,this.__onChangeManager.trigger(this,this.getState()))}getRawValue(){return this.__value}setLocalizations(texts){super.setLocalizations(texts),this.__localizations?.invalidEditor?.invalidSchemaText&&this.__watchLocalization("invalidSchemaText","string"==typeof this.__localizations.invalidEditor.invalidSchemaText?{symbolExpression:this.__localizations.invalidEditor.invalidSchemaText,formatValues:[]}:this.__localizations.invalidEditor.invalidSchemaText,text=>{this.__textContainer.textContent=text})}}Helpers.InvalidEditor=InvalidEditor}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){let ChoiceEditor=(()=>{let ___onSelectionChanged_decorators,___onEditorChanged_decorators,___onEditorConfirmed_decorators,_classSuper=Helpers.Editor,_instanceExtraInitializers=[];return class ChoiceEditor extends _classSuper{static{const _metadata="function"==typeof Symbol&&Symbol.metadata?Object.create(_classSuper[Symbol.metadata]??null):void 0;___onSelectionChanged_decorators=[TcHmi.CallbackMethod],___onEditorChanged_decorators=[TcHmi.CallbackMethod],___onEditorConfirmed_decorators=[TcHmi.CallbackMethod],__esDecorate(this,null,___onSelectionChanged_decorators,{kind:"method",name:"__onSelectionChanged",static:!1,private:!1,access:{has:obj=>"__onSelectionChanged"in obj,get:obj=>obj.__onSelectionChanged},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onEditorChanged_decorators,{kind:"method",name:"__onEditorChanged",static:!1,private:!1,access:{has:obj=>"__onEditorChanged"in obj,get:obj=>obj.__onEditorChanged},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onEditorConfirmed_decorators,{kind:"method",name:"__onEditorConfirmed",static:!1,private:!1,access:{has:obj=>"__onEditorConfirmed"in obj,get:obj=>obj.__onEditorConfirmed},metadata:_metadata},null,_instanceExtraInitializers),_metadata&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_metadata})}__value=__runInitializers(this,_instanceExtraInitializers);__container;__combobox;__editors=new Map;__activeEditor=null;constructor(element,editorInfo,factory){super(element,editorInfo,factory),this.__container=document.createElement("div"),this.__container.classList.add("compound-control-container");const combobox=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiCombobox",`${this.__name}.combobox`,{"data-tchmi-content-padding":{top:3,right:3,bottom:3,left:3}},this.__parentControl);if(!combobox)throw new Error("Could not create controls for choice editor.");this.__combobox=combobox,this.__childControls.add(combobox),this.__eventDestroyers.push(TcHmi.EventProvider.register(combobox.getId()+".onSelectionChanged",this.__onSelectionChanged));const comboboxElement=combobox.getElement()[0];comboboxElement.classList.add("type-combobox"),this.__container.appendChild(comboboxElement),this.__processEditorInfo(),element.appendChild(this.__container)}static createAnyEditorInfo(ref){const info=ref??{};return info.type="choice",info.schema={},info.name="Any",info}static getAnyChoices(){return[{type:"boolean",schema:{},name:"Boolean"},{type:"number",schema:{},name:"Number",specialValues:new Set(["NaN","Infinity","-Infinity"]),restrictions:[]},{type:"string",schema:{},name:"String",restrictions:[]},{type:"time",schema:{},name:"Time",formats:new Set(["date-time","timespan"])},{type:"object",schema:{},name:"Object",properties:new Map,additionalProperties:{allowed:!0,editorInfo:ChoiceEditor.createAnyEditorInfo()}},{type:"array",schema:{},name:"Array",items:ChoiceEditor.createAnyEditorInfo(),uniqueItems:!1},{type:"null",schema:{},name:"Null"}]}static validate(editorInfo,value){return!editorInfo.choices||editorInfo.choices.some(info=>Helpers.Editor.validate(info,value))}static checkForErrors(editorInfo,value,returnEarly=!1){if(!editorInfo.choices)return[];const errors=[];for(const choice of editorInfo.choices){const underlyingErrors=Helpers.Editor.checkForErrors(choice,value,returnEarly);if(0===underlyingErrors.length)return[];errors.push({error:Helpers.Editor.Error.DOES_NOT_FIT_THIS_CHOICE,parameters:[value,choice.name],underlying:underlyingErrors})}return[{error:Helpers.Editor.Error.DOES_NOT_FIT_ANY_CHOICE,parameters:[value],underlying:errors}]}startEditing(){if(!this.__activeEditor)return this.__combobox.focus(),void this.__combobox.open();this.__activeEditor.editor.startEditing?.()}__processEditorInfo(){const choices=this.__editorInfo.choices??ChoiceEditor.getAnyChoices();if(this.__combobox.setSrcData(choices.map(choice=>({text:choice.name}))),this.__activeEditor){const currentlyChosenEditorInfo=this.__activeEditor.editor.getEditorInfo(),unboxedType="optional"===currentlyChosenEditorInfo.type?currentlyChosenEditorInfo.editorInfo.type:currentlyChosenEditorInfo.type;choices.some(choice=>"optional"!==choice.type?choice.type===unboxedType:choice.editorInfo.type===unboxedType&&"optional"===currentlyChosenEditorInfo.type)||(this.__activeEditor.container.remove(),this.__activeEditor.editor.onChange.remove(this.__onEditorChanged),this.__activeEditor.editor.onConfirm.remove(this.__onEditorConfirmed),this.__activeEditor=null,this.__onChangeManager.trigger(this,this.getState()))}for(const[type,editorEntry]of this.__editors){const editorInfo=editorEntry.editor.getEditorInfo(),unboxedType="optional"===editorInfo.type?editorInfo.editorInfo.type:editorInfo.type;choices.some(choice=>"optional"!==choice.type?choice.type===unboxedType:choice.editorInfo.type===unboxedType&&"optional"===editorInfo.type)||this.__editors.delete(type)}}__onSelectionChanged(){const choices=this.__editorInfo.choices??ChoiceEditor.getAnyChoices(),index=this.__combobox.getSelectedIndex();if(null==index||index<0||index>=choices.length)this.__activeEditor?.container.remove(),this.__activeEditor?.editor.onChange.remove(this.__onEditorChanged),this.__activeEditor?.editor.onConfirm.remove(this.__onEditorConfirmed),this.__activeEditor=null;else{const editorInfo=choices[index];let editorEntry=this.__editors.get(editorInfo.type);if(!editorEntry){const container=document.createElement("div");container.classList.add("choice-sub-editor"),editorEntry={editor:this.__factory.fromEditorInfo(editorInfo,container,this),container},this.__editors.set(editorInfo.type,editorEntry)}editorEntry.editor.setEditorInfo(editorInfo),editorEntry.editor.setIsReadOnly(this.__isReadOnly),editorEntry.editor.setSettings(this.__settings),editorEntry.editor.setValue(this.__value),this.__activeEditor?(this.__activeEditor.container.replaceWith(editorEntry.container),this.__activeEditor.editor.onChange.remove(this.__onEditorChanged),this.__activeEditor.editor.onConfirm.remove(this.__onEditorConfirmed)):this.__container.prepend(editorEntry.container),editorEntry.editor.onChange.add(this.__onEditorChanged),editorEntry.editor.onConfirm.add(this.__onEditorConfirmed),this.__activeEditor=editorEntry;const state=this.getState();this.__onChangeManager.trigger(this,state),state.isValid&&"null"===editorInfo.type&&this.__onConfirmManager.trigger(this,state)}}__onEditorChanged(editor,state){this.__value=editor.getRawValue(),this.__onChangeManager.trigger(this,state)}__onEditorConfirmed(_editor,state){this.__onConfirmManager.trigger(this,state)}setValue(value){if(this.__value=value,this.__activeEditor&&Helpers.Editor.validate(this.__activeEditor.editor.getEditorInfo(),value))return void this.__activeEditor.editor.setValue(value);const currentComboboxIndex=this.__combobox.getSelectedIndex(),availableTypes=[],choices=this.__editorInfo.choices??ChoiceEditor.getAnyChoices();for(const[index,choice]of choices.entries()){if(Helpers.Editor.validate(choice,value))return void this.__combobox.setSelectedIndex(index);availableTypes.push("optional"!==choice.type?choice.type:choice.editorInfo.type)}const currentlyChosenEditorInfo=this.__activeEditor?.editor.getEditorInfo(),currentType="optional"===currentlyChosenEditorInfo?.type?currentlyChosenEditorInfo.editorInfo.type:currentlyChosenEditorInfo?.type??null;let index;switch(typeof value){case"boolean":index=availableTypes.indexOf("boolean"),-1!==index&&currentType!==availableTypes[index]&&this.__combobox.setSelectedIndex(index);break;case"number":index=availableTypes.indexOf("number"),-1!==index&&currentType!==availableTypes[index]&&this.__combobox.setSelectedIndex(index);break;case"string":index=availableTypes.indexOf("string"),-1===index&&(index=availableTypes.indexOf("time")),-1!==index&&currentType!==availableTypes[index]&&this.__combobox.setSelectedIndex(index);break;case"object":null===value?index=availableTypes.indexOf("null"):Array.isArray(value)?(index=availableTypes.indexOf("array"),-1===index&&(index=availableTypes.indexOf("tuple"))):index=availableTypes.indexOf("object"),-1!==index&&currentType!==availableTypes[index]&&this.__combobox.setSelectedIndex(index)}this.__activeEditor&&this.__combobox.getSelectedIndex()===currentComboboxIndex&&this.__activeEditor.editor.setValue(value)}getState(){return this.__activeEditor?this.__activeEditor.editor.getState():{isValid:!1}}getRawValue(){return this.__activeEditor?this.__activeEditor.editor.getRawValue():this.__value}__processIsReadOnly(){this.__combobox.setIsReadOnly(this.__isReadOnly);for(const editorEntry of this.__editors.values())editorEntry.editor.setIsReadOnly(this.__isReadOnly)}setSettings(settings){super.setSettings(settings);for(const editorEntry of this.__editors.values())editorEntry.editor.setSettings(this.__settings)}setLocalizations(texts){if(super.setLocalizations(texts),this.__localizations){this.__localizations.choiceEditor?.comboboxText&&("string"==typeof this.__localizations.choiceEditor.comboboxText?(this.__unwatchLocalization("comboboxText"),TcHmi.Binding.createEx2(this.__localizations.choiceEditor.comboboxText,"comboboxText",this.__combobox)):(TcHmi.Binding.removeEx2(null,"comboboxText",this.__combobox),this.__watchLocalization("comboboxText",this.__localizations.choiceEditor.comboboxText,text=>this.__combobox.setComboboxText(text))));for(const editorEntry of this.__editors.values())editorEntry.editor.setLocalizations(this.__localizations)}}}})();Helpers.ChoiceEditor=ChoiceEditor}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){class HistorizedSymbolEditor extends Helpers.ButtonBasedEditor{static#tchmiFQN="TcHmi.Controls.Helpers."+this.name;__value="";__stringEditor;__popupHeader="";constructor(element,editorInfo,factory){super(element,editorInfo,factory),this.__textSpan.classList.remove("value-description"),this.__textSpan.classList.add("value-editor"),this.__stringEditor=new Helpers.StringEditor(this.__textSpan,editorInfo,factory),this.__stringEditor.onChange.add(()=>{const stringState=this.__stringEditor.getState(),value=stringState.isValid?stringState.value:this.__stringEditor.getRawValue();this.__value=value,this.__popup?.setValue(value);const historizedSymbolState=this.getState();this.__container.classList.toggle("invalid",!historizedSymbolState.isValid),this.__onChangeManager.trigger(this,historizedSymbolState)}),this.__stringEditor.onConfirm.add(()=>{const state=this.getState();state.isValid&&this.__onConfirmManager.trigger(this,state)}),this.__processEditorInfo(),this.__localizations={...this.__localizations,historizedSymbolEditor:{promptHeader:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Prompt_Header_HistorizedSymbol%/l%",nameColumnHeader:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Column_Header_Name%/l%",dataTypeColumnHeader:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Column_Header_DataType%/l%",recordingColumnHeader:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Column_Header_Recording%/l%",intervalColumnHeader:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Column_Header_Interval%/l%",maxEntriesColumnHeader:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Column_Header_MaxEntries%/l%",yesText:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Text_Yes%/l%",noText:"%l%Package::Beckhoff.TwinCAT.HMI.Controls::Helpers_JsonEditors_Text_No%/l%"}}}destroy(){super.destroy(),this.__popup?.destroy(!0)}async openPopup(){this.__popup||(this.__popup=new Helpers.EditorPrompt(this.__editorInfo,Helpers.HistorizedSymbolEditorPane,this.__factory),this.__popup.setBackgroundAction({close:!0,action:"cancel"}),this.__popup.setIsReadOnly(this.__isReadOnly),this.__popup.setSettings(this.__settings),this.__popup.setLocalizations({buttonTextOk:this.__localizations?.editorPrompt?.buttonTextOk,buttonTooltipOk:this.__localizations?.editorPrompt?.buttonTooltipOk,buttonTextCancel:this.__localizations?.editorPrompt?.buttonTextCancel,buttonTooltipCancel:this.__localizations?.editorPrompt?.buttonTooltipCancel,editorLocalizations:this.__localizations}),this.__popupHeader&&this.__popup.setHeaderText(this.__popupHeader));try{this.__popup.setValue(this.__value);const result=await this.__popup.prompt();if(result.isOk){this.__value=result.value,this.__stringEditor.setValue(result.value);const state=this.getState();this.__container.classList.toggle("invalid",!state.isValid),this.__onChangeManager.trigger(this,state),state.isValid&&this.__onConfirmManager.trigger(this,state)}}catch(ex){}}setValue(value){this.__value=value??"",this.__stringEditor.setValue(value),this.__popup?.setValue(value);const state=this.getState();this.__container.classList.toggle("invalid",!state.isValid),this.__onChangeManager.trigger(this,state)}getRawValue(){return this.__value}__processEditorInfo(){this.__popup?.setEditorInfo(this.__editorInfo),this.__container.classList.toggle("invalid",!this.getState().isValid)}setSettings(settings){super.setSettings(settings)}setLocalizations(texts){super.setLocalizations(texts),this.__localizations?.historizedSymbolEditor?.promptHeader&&this.__watchLocalization("promptHeader","string"==typeof this.__localizations.historizedSymbolEditor.promptHeader?{symbolExpression:this.__localizations.historizedSymbolEditor.promptHeader,formatValues:[]}:this.__localizations.historizedSymbolEditor.promptHeader,text=>{this.__popupHeader=text,this.__popup?.setHeaderText(text)})}}Helpers.HistorizedSymbolEditor=HistorizedSymbolEditor}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){let HistorizedSymbolEditorPane=(()=>{let ___onHistorizedSymbolsWatch_decorators,___onRowClick_decorators,___onRowDoubleClick_decorators,_classSuper=Helpers.Editor,_instanceExtraInitializers=[];return class HistorizedSymbolEditorPane extends _classSuper{static{const _metadata="function"==typeof Symbol&&Symbol.metadata?Object.create(_classSuper[Symbol.metadata]??null):void 0;___onHistorizedSymbolsWatch_decorators=[TcHmi.CallbackMethod],___onRowClick_decorators=[TcHmi.CallbackMethod],___onRowDoubleClick_decorators=[TcHmi.CallbackMethod],__esDecorate(this,null,___onHistorizedSymbolsWatch_decorators,{kind:"method",name:"__onHistorizedSymbolsWatch",static:!1,private:!1,access:{has:obj=>"__onHistorizedSymbolsWatch"in obj,get:obj=>obj.__onHistorizedSymbolsWatch},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onRowClick_decorators,{kind:"method",name:"__onRowClick",static:!1,private:!1,access:{has:obj=>"__onRowClick"in obj,get:obj=>obj.__onRowClick},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onRowDoubleClick_decorators,{kind:"method",name:"__onRowDoubleClick",static:!1,private:!1,access:{has:obj=>"__onRowDoubleClick"in obj,get:obj=>obj.__onRowDoubleClick},metadata:_metadata},null,_instanceExtraInitializers),_metadata&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_metadata})}static#tchmiFQN="TcHmi.Controls.Helpers."+this.name;__value=(__runInitializers(this,_instanceExtraInitializers),"");__tableHeaders;__tableBody;__historizedSymbols=null;__destroyWatch=null;__localizedCells={yes:{text:"",elements:new Set},no:{text:"",elements:new Set}};constructor(element,editorInfo,factory){super(element,editorInfo,factory);const table=document.createElement("table"),tr=table.appendChild(document.createElement("thead")).appendChild(document.createElement("tr"));this.__tableHeaders={name:tr.appendChild(document.createElement("th")),dataType:tr.appendChild(document.createElement("th")),recording:tr.appendChild(document.createElement("th")),interval:tr.appendChild(document.createElement("th")),maxEntries:tr.appendChild(document.createElement("th"))},this.__tableBody=table.appendChild(document.createElement("tbody")),element.appendChild(table),this.__eventDestroyers.push(TcHmi.EventProvider.registerDomEvent(this.__tableBody,"click",this.__onRowClick),TcHmi.EventProvider.registerDomEvent(this.__tableBody,"dblclick",this.__onRowDoubleClick)),this.__settings.historizedSymbolEditor?.domain&&(this.__historizedSymbols=new TcHmi.Symbol(`%s%${this.__settings.historizedSymbolEditor.domain}.Config::historizedSymbolList%/s%`),this.__destroyWatch=this.__historizedSymbols.watch(this.__onHistorizedSymbolsWatch))}destroy(){super.destroy(),this.__destroyWatch?.(),this.__destroyWatch=null,this.__historizedSymbols?.destroy(),this.__historizedSymbols=null}setValue(value){if(this.__value!==(value??"")){this.__value=value??"",this.__onChangeManager.trigger(this,this.getState());const row=this.__tableBody.querySelector(`tr[data-name="${value}"]`);this.__select(row)}}getRawValue(){return this.__value}__processEditorInfo(){}__processIsReadOnly(){this.__element.classList.toggle("read-only",this.__isReadOnly)}__onHistorizedSymbolsWatch(data){if(data.error)return void(this.__parentControl?TcHmi.Log.Controls.error(this.__parentControl,HistorizedSymbolEditorPane.#tchmiFQN,{SymbolExpression:data.expression?.toString()},TcHmi.Log.buildMessage(data.details)):TcHmi.Log.errorEx(`[Source=Control, Module=Beckhoff.TwinCAT.HMI.Controls, Origin=${HistorizedSymbolEditorPane.#tchmiFQN}, SymbolExpression=${data.expression?.toString()}] `+TcHmi.Log.buildMessage(data.details)));const historizedSymbols=data.value??{};let currentRow=this.__tableBody.firstElementChild;const rowsToAdd=document.createDocumentFragment();for(const[name,info]of Object.entries(historizedSymbols)){currentRow||(currentRow=rowsToAdd.appendChild(document.createElement("tr")));const cells={};let currentCell=currentRow.firstElementChild;for(const name of Object.keys(this.__tableHeaders))cells[name]=currentCell??currentRow.appendChild(document.createElement("td")),cells[name].dataset.name=name,currentCell=currentCell?.nextElementSibling??null;cells.name.textContent=name,info.recordingEnabled?(this.__localizedCells.no.elements.delete(cells.recording),this.__localizedCells.yes.elements.add(cells.recording),cells.recording.textContent=this.__localizedCells.yes.text):(this.__localizedCells.yes.elements.delete(cells.recording),this.__localizedCells.no.elements.add(cells.recording),cells.recording.textContent=this.__localizedCells.no.text),cells.interval.textContent=info.interval,cells.maxEntries.textContent=info.maxEntries.toString(10),TcHmi.Symbol.resolveSchema(`%s%${name}%/s%`,data=>{data.schema&&(cells.dataType.textContent=Helpers.SchemaParser.generateName(data.schema))}),currentRow.dataset.name=name,currentRow.classList.toggle("selected",name===this.__value),currentRow=currentRow.nextElementSibling}for(;currentRow;){const next=currentRow.nextElementSibling;currentRow.remove(),currentRow=next}this.__tableBody.appendChild(rowsToAdd)}__onRowClick(event){if(this.__parentControl){if(!this.__parentControl.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this.__parentControl,"operate"))return}if(this.__isReadOnly)return;const row=event.target.closest("tr");row&&this.__select(row)}__onRowDoubleClick(event){if(this.__parentControl){if(!this.__parentControl.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this.__parentControl,"operate"))return}if(this.__isReadOnly)return;if(!event.target.closest("tr"))return;const state=this.getState();state.isValid&&this.__onConfirmManager.trigger(this,state)}__select(row){this.__tableBody.querySelector("tr.selected")?.classList.remove("selected"),row&&(row.classList.add("selected"),this.__value!==(row.dataset.name??"")&&(this.__value=row.dataset.name??"",this.__onChangeManager.trigger(this,this.getState())))}setSettings(settings){const update=settings.historizedSymbolEditor?.domain!==this.__settings.historizedSymbolEditor?.domain;super.setSettings(settings),update&&(this.__destroyWatch?.(),this.__historizedSymbols?.destroy(),this.__settings.historizedSymbolEditor?.domain?(this.__historizedSymbols=new TcHmi.Symbol(`%s%${this.__settings.historizedSymbolEditor.domain}.Config::historizedSymbolList%/s%`),this.__destroyWatch=this.__historizedSymbols.watch(this.__onHistorizedSymbolsWatch)):(this.__destroyWatch=null,this.__historizedSymbols=null))}setLocalizations(texts){super.setLocalizations(texts),this.__localizations?.historizedSymbolEditor?.nameColumnHeader&&this.__watchLocalization("nameColumnHeader","string"==typeof this.__localizations.historizedSymbolEditor.nameColumnHeader?{symbolExpression:this.__localizations.historizedSymbolEditor.nameColumnHeader,formatValues:[]}:this.__localizations.historizedSymbolEditor.nameColumnHeader,text=>{this.__tableHeaders.name.textContent=text}),this.__localizations?.historizedSymbolEditor?.dataTypeColumnHeader&&this.__watchLocalization("dataTypeColumnHeader","string"==typeof this.__localizations.historizedSymbolEditor.dataTypeColumnHeader?{symbolExpression:this.__localizations.historizedSymbolEditor.dataTypeColumnHeader,formatValues:[]}:this.__localizations.historizedSymbolEditor.dataTypeColumnHeader,text=>{this.__tableHeaders.dataType.textContent=text}),this.__localizations?.historizedSymbolEditor?.recordingColumnHeader&&this.__watchLocalization("recordingColumnHeader","string"==typeof this.__localizations.historizedSymbolEditor.recordingColumnHeader?{symbolExpression:this.__localizations.historizedSymbolEditor.recordingColumnHeader,formatValues:[]}:this.__localizations.historizedSymbolEditor.recordingColumnHeader,text=>{this.__tableHeaders.recording.textContent=text}),this.__localizations?.historizedSymbolEditor?.intervalColumnHeader&&this.__watchLocalization("intervalColumnHeader","string"==typeof this.__localizations.historizedSymbolEditor.intervalColumnHeader?{symbolExpression:this.__localizations.historizedSymbolEditor.intervalColumnHeader,formatValues:[]}:this.__localizations.historizedSymbolEditor.intervalColumnHeader,text=>{this.__tableHeaders.interval.textContent=text}),this.__localizations?.historizedSymbolEditor?.maxEntriesColumnHeader&&this.__watchLocalization("maxEntriesColumnHeader","string"==typeof this.__localizations.historizedSymbolEditor.maxEntriesColumnHeader?{symbolExpression:this.__localizations.historizedSymbolEditor.maxEntriesColumnHeader,formatValues:[]}:this.__localizations.historizedSymbolEditor.maxEntriesColumnHeader,text=>{this.__tableHeaders.maxEntries.textContent=text}),this.__localizations?.historizedSymbolEditor?.yesText&&this.__watchLocalization("yesText","string"==typeof this.__localizations.historizedSymbolEditor.yesText?{symbolExpression:this.__localizations.historizedSymbolEditor.yesText,formatValues:[]}:this.__localizations.historizedSymbolEditor.yesText,text=>{this.__localizedCells.yes.text=text;for(const cell of this.__localizedCells.yes.elements)cell.textContent=text}),this.__localizations?.historizedSymbolEditor?.noText&&this.__watchLocalization("noText","string"==typeof this.__localizations.historizedSymbolEditor.noText?{symbolExpression:this.__localizations.historizedSymbolEditor.noText,formatValues:[]}:this.__localizations.historizedSymbolEditor.noText,text=>{this.__localizedCells.no.text=text;for(const cell of this.__localizedCells.no.elements)cell.textContent=text})}}})();Helpers.HistorizedSymbolEditorPane=HistorizedSymbolEditorPane}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){let EditorPrompt=(()=>{let ___onEditorChanged_decorators,___onEditorConfirmed_decorators,_classSuper=Helpers.OkCancelPrompt,_instanceExtraInitializers=[];return class extends _classSuper{static{const _metadata="function"==typeof Symbol&&Symbol.metadata?Object.create(_classSuper[Symbol.metadata]??null):void 0;___onEditorChanged_decorators=[TcHmi.CallbackMethod],___onEditorConfirmed_decorators=[TcHmi.CallbackMethod],__esDecorate(this,null,___onEditorChanged_decorators,{kind:"method",name:"__onEditorChanged",static:!1,private:!1,access:{has:obj=>"__onEditorChanged"in obj,get:obj=>obj.__onEditorChanged},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onEditorConfirmed_decorators,{kind:"method",name:"__onEditorConfirmed",static:!1,private:!1,access:{has:obj=>"__onEditorConfirmed"in obj,get:obj=>obj.__onEditorConfirmed},metadata:_metadata},null,_instanceExtraInitializers),_metadata&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_metadata})}__editorPane=__runInitializers(this,_instanceExtraInitializers);constructor(editorInfo,editorConstructor,factory){super(factory.parentControl),this.__elementHeader.textContent=editorInfo.name,this.__editorPane=new editorConstructor(this.__elementContent,editorInfo,factory),this.__editorPane.onChange.add(this.__onEditorChanged),this.__editorPane.onConfirm.add(this.__onEditorConfirmed)}destroy(force=!1){super.destroy(force),this.__editorPane.destroy()}setHeaderText(text){this.__elementHeader.textContent=text}setEditorInfo(editorInfo){this.__editorPane.setEditorInfo(editorInfo)}setIsReadOnly(isReadOnly){this.__editorPane.setIsReadOnly(isReadOnly)}setSettings(settings){this.__editorPane.setSettings(settings)}setValue(value){this.__editorPane.setValue(value)}__onEditorChanged(_editor,state){this.__okButton.setIsEnabled(state.isValid)}__onEditorConfirmed(_editor,_state){this.__ok()}__ok(){const state=this.__editorPane.getState();state.isValid?this.__prompt?.answer({isOk:!0,value:state.value}):this.__prompt?.error(new Error("Editor pane contained invalid values."))}setLocalizations(texts){super.setLocalizations(texts),texts.editorLocalizations&&this.__editorPane.setLocalizations(texts.editorLocalizations)}}})();Helpers.EditorPrompt=EditorPrompt}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){class ObjectEditorPrompt extends Helpers.EditorPrompt{constructor(editorInfo,factory){super(editorInfo,Helpers.ObjectEditorPane,factory)}}Helpers.ObjectEditorPrompt=ObjectEditorPrompt}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){class ArrayEditorPrompt extends Helpers.EditorPrompt{constructor(editorInfo,factory){super(editorInfo,Helpers.ArrayEditorPane,factory)}}Helpers.ArrayEditorPrompt=ArrayEditorPrompt}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Helpers){class TupleEditorPrompt extends Helpers.EditorPrompt{constructor(editorInfo,factory){super(editorInfo,Helpers.TupleEditorPane,factory)}}Helpers.TupleEditorPrompt=TupleEditorPrompt}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={}));