"use strict";!function(TcHmi){!function(Controls){!function(Helpers){class Banner{__parentControl;static#tchmiFQN="TcHmi.Controls.Helpers."+this.name;__name;__targetElement;__element;__elementHeaderContainer;__elementHeader;__elementContent;__elementFooter;__childControls=[];__destroyers=[];__isShowing=!1;__localizationSymbols=new Map;__className="TcHmi_Controls_Helpers_Banner";constructor(targetElement,__parentControl){this.__parentControl=__parentControl,this.__name=`${this.constructor.name}-${tchmi_create_guid()}`,this.__parentControl&&(this.__name=`${this.__parentControl.getId()}.${this.__name}`),this.__targetElement=targetElement;const controlClass=this.__parentControl?.getType().replace(/\./g,"_");this.__element=document.createElement("div"),this.__element.classList.add(this.__className,`${this.__className}-${this.constructor.name}`),controlClass&&this.__element.classList.add(`${controlClass}-banner`),this.__elementHeaderContainer=document.createElement("div"),this.__elementHeaderContainer.classList.add(`${this.__className}-header-container`),this.__elementHeader=document.createElement("h1"),this.__elementHeaderContainer.appendChild(this.__elementHeader),this.__element.appendChild(this.__elementHeaderContainer),this.__elementContent=document.createElement("div"),this.__elementContent.classList.add(`${this.__className}-content`),this.__element.appendChild(this.__elementContent),this.__elementFooter=document.createElement("div"),this.__elementFooter.classList.add(`${this.__className}-footer`),this.__element.appendChild(this.__elementFooter),this.__parentControl&&this.__destroyers.push(TcHmi.EventProvider.register(this.__parentControl.getId()+".onDestroyed",()=>{this.destroy()}))}isShowing(){return this.__isShowing}show(){this.__isShowing||(this.__isShowing=!0,this.__targetElement.appendChild(this.__element))}hide(){this.__isShowing&&(this.__isShowing=!1,this.__element.remove())}destroy(force=!1){for(const destroy of this.__destroyers)destroy();this.__destroyers=[];for(const control of this.__childControls)force&&this.__parentControl&&this.__parentControl.__removeChild(control),control.destroy();this.__childControls=[];for(const entry of this.__localizationSymbols.values())entry.destroyWatch(),entry.symbol.destroy();this.__localizationSymbols.clear()}__watchLocalization(name,localization,onChange){const existing=this.__localizationSymbols.get(name);existing?.destroyWatch(),existing?.symbol.destroy();const symbol=new TcHmi.Symbol(localization.symbolExpression),destroyWatch=symbol.watch(data=>{if(data.error!==TcHmi.Errors.NONE)return void TcHmi.Log.errorEx(`[Source=ControlHelpers, Module=${Banner.#tchmiFQN}${this.__parentControl?`, Id=${this.__parentControl.getId()}`:""}, SymbolExpression=${localization.symbolExpression}] `+TcHmi.Log.buildMessage(data.details));let text=data.value??"";localization.formatValues.length>0&&(text=tchmi_format_string(text,...localization.formatValues)),onChange(text)});this.__localizationSymbols.set(name,{symbol,destroyWatch})}__unwatchLocalization(name){const existing=this.__localizationSymbols.get(name);existing&&(existing.destroyWatch(),existing.symbol.destroy(),this.__localizationSymbols.delete(name))}setTexts(texts){void 0!==texts.headerText&&null!==texts.headerText&&("object"==typeof texts.headerText||TcHmi.Symbol.isSymbolExpression(texts.headerText)?this.__watchLocalization("headerText","string"==typeof texts.headerText?{symbolExpression:texts.headerText,formatValues:[]}:texts.headerText,text=>this.__elementHeader.textContent=text):(this.__unwatchLocalization("headerText"),this.__elementHeader.textContent=texts.headerText)),void 0!==texts.contentText&&null!==texts.contentText&&("object"==typeof texts.contentText||TcHmi.Symbol.isSymbolExpression(texts.contentText)?this.__watchLocalization("contentText","string"==typeof texts.contentText?{symbolExpression:texts.contentText,formatValues:[]}:texts.contentText,text=>this.__elementContent.textContent=text):(this.__unwatchLocalization("contentText"),this.__elementContent.textContent=texts.contentText))}}Helpers.Banner=Banner}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={}));var TcHmi,__runInitializers=this&&this.__runInitializers||function(thisArg,initializers,value){for(var useValue=arguments.length>2,i=0;i<initializers.length;i++)value=useValue?initializers[i].call(thisArg,value):initializers[i].call(thisArg);return useValue?value:void 0},__esDecorate=this&&this.__esDecorate||function(ctor,descriptorIn,decorators,contextIn,initializers,extraInitializers){function accept(f){if(void 0!==f&&"function"!=typeof f)throw new TypeError("Function expected");return f}for(var _,kind=contextIn.kind,key="getter"===kind?"get":"setter"===kind?"set":"value",target=!descriptorIn&&ctor?contextIn.static?ctor:ctor.prototype:null,descriptor=descriptorIn||(target?Object.getOwnPropertyDescriptor(target,contextIn.name):{}),done=!1,i=decorators.length-1;i>=0;i--){var context={};for(var p in contextIn)context[p]="access"===p?{}:contextIn[p];for(var p in contextIn.access)context.access[p]=contextIn.access[p];context.addInitializer=function(f){if(done)throw new TypeError("Cannot add initializers after decoration has completed");extraInitializers.push(accept(f||null))};var result=(0,decorators[i])("accessor"===kind?{get:descriptor.get,set:descriptor.set}:descriptor[key],context);if("accessor"===kind){if(void 0===result)continue;if(null===result||"object"!=typeof result)throw new TypeError("Object expected");(_=accept(result.get))&&(descriptor.get=_),(_=accept(result.set))&&(descriptor.set=_),(_=accept(result.init))&&initializers.unshift(_)}else(_=accept(result))&&("field"===kind?initializers.unshift(_):descriptor[key]=_)}target&&Object.defineProperty(target,contextIn.name,descriptor),done=!0};!function(TcHmi){!function(Controls){!function(Helpers){let ApprovalBanner=(()=>{let ___onApproved_decorators,_classSuper=Helpers.Banner,_instanceExtraInitializers=[];return class extends _classSuper{static{const _metadata="function"==typeof Symbol&&Symbol.metadata?Object.create(_classSuper[Symbol.metadata]??null):void 0;___onApproved_decorators=[TcHmi.CallbackMethod],__esDecorate(this,null,___onApproved_decorators,{kind:"method",name:"__onApproved",static:!1,private:!1,access:{has:obj=>"__onApproved"in obj,get:obj=>obj.__onApproved},metadata:_metadata},null,_instanceExtraInitializers),_metadata&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_metadata})}__parentControl=__runInitializers(this,_instanceExtraInitializers);__approveButton;__repetitionCheckbox;__storage;constructor(targetElement,storageId,__parentControl){super(targetElement,__parentControl),this.__parentControl=__parentControl,storageId&&(this.__storage=new TcHmi.LocalStorage(storageId,{}));const approveButton=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__name}.approveButton`,{"data-tchmi-width":60,"data-tchmi-height":30,"data-tchmi-is-enabled":!0,"data-tchmi-ignore-escape-sequences":!0},this.__parentControl),repetitionCheckbox=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiCheckbox",`${this.__name}.rememberChoiceCheckbox`,{"data-tchmi-height":30,"data-tchmi-is-enabled":!0,"data-tchmi-ignore-escape-sequences":!0},this.__parentControl);if(!approveButton||!repetitionCheckbox)throw new Error("Could not create controls for ApprovalBanner.");this.__storage&&(this.__elementFooter.appendChild(repetitionCheckbox.getElement()[0]),repetitionCheckbox.getElement()[0].style.gridColumn="1"),this.__elementFooter.appendChild(approveButton.getElement()[0]),approveButton.getElement()[0].style.gridColumn="2",this.__destroyers.push(TcHmi.EventProvider.register(approveButton.getId()+".onPressed",this.__onApproved)),this.__approveButton=approveButton,this.__repetitionCheckbox=repetitionCheckbox}show(){!0!==this.__storage?.get("dontShowAgain")&&super.show()}__onApproved(){if(this.__parentControl){if(!this.__parentControl.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this.__parentControl,"operate"))return}this.__storage&&this.__repetitionCheckbox&&this.__storage.set("dontShowAgain","Active"===this.__repetitionCheckbox.getToggleState()),this.hide()}setTexts(texts){super.setTexts(texts),void 0!==texts.buttonText&&null!==texts.buttonText&&("string"==typeof texts.buttonText?(this.__unwatchLocalization("buttonText"),TcHmi.Symbol.isSymbolExpression(texts.buttonText)?TcHmi.Binding.createEx2(texts.buttonText,"Text",this.__approveButton):this.__approveButton.setText(texts.buttonText)):(TcHmi.Binding.removeEx2(null,"Text",this.__approveButton),this.__watchLocalization("buttonText",texts.buttonText,text=>this.__approveButton.setText(text)))),void 0!==texts.checkboxText&&null!==texts.checkboxText&&("string"==typeof texts.checkboxText?(this.__unwatchLocalization("checkboxText"),TcHmi.Symbol.isSymbolExpression(texts.checkboxText)?TcHmi.Binding.createEx2(texts.checkboxText,"Text",this.__repetitionCheckbox):this.__repetitionCheckbox.setText(texts.checkboxText)):(TcHmi.Binding.removeEx2(null,"Text",this.__repetitionCheckbox),this.__watchLocalization("checkboxText",texts.checkboxText,text=>this.__repetitionCheckbox.setText(text))))}}})();Helpers.ApprovalBanner=ApprovalBanner}(Controls.Helpers||(Controls.Helpers={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={}));